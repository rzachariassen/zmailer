This is my implementation of policy based SMTP filtering in ZMailer 2.99.45.

How to use it?

- copy db.c to $SRC/router/db.c or apply db.c-patch against $SRC/router/db.c
- copy smtpserver.c to $SRC/smtpserver/smtpserver.c
  or apply smtpserver.c-patch against $SRC/smtpserver/smtpserver.c
- create new router and smtpserver binaries
- stop router and smtpserver daemon
- install the new deamons
- copy server.cf to $MAILSHARE/db/server.cf
- copy policy to $MAILVAR/cf/policy
- read sample policy file, study syntax and semantic rules,
  create your one and run makenbdm on it.
- make sure, that server.cf refers to the same type database you created
  (-t option of relation command)
- restart deamons. smtpserver needs -sfth options.

Files:

README		- this file
db.c		- replacement of version 2.99.45 $SRC/router/db.c
smtpserver.c	- replacement of version 2.99.45 $SRC/smtpserver/smtpserver.c
db.c-patch	- context diff of original and modified db.c
smtpserver.c-patch - context diff of original and modified smtpserver.c
server.cf	- replacement of version 2.99.45 $MAILSHARE/db/server.cf
policy		- sample filter configuration file

Disclaimer

#  THIS CODE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED
#  WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
#  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.

This is a first version of my filter.
Any comments are welcome. Write to: <kissg@sztaki.hu>

Gabor Kiss
