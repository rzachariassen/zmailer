#
# smtpserver.conf - autogenerated edition
#
#### global parameters ####
#
#PARAM maxsize              10000000    # Same as -M -option
#PARAM min-availspace           5000    # Minimum free in POSTOFFICE after
#                                       # message has arrived; in KILOBYTES.
#PARAM MaxSameIpSource            10    # Max simultaneous connections
#                                       # from any IP source address
#PARAM MaxParallelConnections    800    # Max simultaneous connections
#                                       # in total to the server
#PARAM max-unknown-commands       10    # Max unknown cmds before we hung up
#                                       # because we thing the client is
#                                       # broken/spammer/something
#
PARAM  enable-router    # This is a security decission for you.
#       # This is needed for EXPN/VRFY and interactive
#       # processing of MAIL FROM and RCPT TO addresses.
#       # However it also may allow external user entrance
#       # to ZMailer router shell environment with suitably
#       # pervert input, if quotation rules are broken in
#       # the scripts.
PARAM  enable-router-maxpar 2
#       # Resource control: Start at most 2 interactive
#       # routers, if such are needed. The value range
#       # is 1 thru 20 ...
#
#PARAM perl-hook  /path/to/smtpserver-perl-hook.pl  # (still experimental)
#
#
# HDR220 metatags:
#  %%  =  '%' character
#  %H  =  myhostname
#  %I  =  '+IDENT' if 'identflg' is set
#  %i -- remote IP address in text literal form
#  %V  =  VersionNumb
#  %T  =  curtime string
#  %X  =  xlatelang parameter
#
#PARAM hdr220 %H ZMailer ESMTP-server %V running at Yoyodyne Propulsion Inc
#PARAM hdr220 %H ESMTP (NO UCE)(NO UBE) our local time is now %T
#
# Note above the "ESMTP" words are present because *some* MTA systems won't
# do EHLO greeting, unless they see "ESMTP" - against RFC 1869 part 4.
# "EHLO is to be done blindly, server responses are not to be studied for
#  any possible 'ESMTP' keyword!"
#
#
#PARAM help =============================================================
#PARAM help  This mail-server is at Yoyodyne Propulsion Inc.
#PARAM help  Our telephone number is: +1-234-567-8900, and
#PARAM help  telefax number is: +1-234-567-8999
#PARAM help  Our business-hours are Mon-Fri: 0800-1700 (Timezone: -0700)
#PARAM help
#PARAM help  Questions regarding our email service should be sent via
#PARAM help  email to address  <postmaster@OURDOMAIN>
#PARAM help  Reports about abuse are to be sent to: <abuse@OURDOMAIN>
#PARAM help =============================================================

# A load-balanced server cluster may want to communicate
# the ETRN request to cluster components, here is how:
# See also:  doc/guides/etrn-cluster
#
#PARAM etrn-cluster localhost              mq-etrn-user mq-etrn-pw
#PARAM etrn-cluster node-2-name-or-address mq-etrn-user mq-etrn-pw
#PARAM etrn-cluster node-3-name-or-address mq-etrn-user mq-etrn-pw
#...
#PARAM etrn-cluster node-40-name-or-address mq-etrn-user mq-etrn-pw

#PARAM lmtp-mode        # When wanting to emulate LMTP server,
#                       # In reality this is only for debugging
#                       # the smtp TA's LMTP mode.

# Uncomment following for not to strip incoming addresses of format:
# <@aa,@bb:cc@dd> into non-source-routed base form: <cc@dd>
#
#PARAM  allowsourceroute
#      # DON'T ENABLE UNLESS YOU USE ROUTER BASED
#      # POLICY ANALYSIS!  (Which doesn't exist anymore!)


##### GROUP PARAMETERS -- DEFAULT SETTINGS #####

#PARAM max-error-recipients        3    # More than this is probably SPAM!
#
#PARAM TcpRcvBufferSize        32000    # Should not need to set!
#PARAM TcpXmitBufferSize       32000    # Should not need to set!
#
#PARAM ListenQueueSize         20000    # listen(2) parameter
#
#PARAM RcptLimitCount          10000    # Max number of recipients for one
#                                       # MAIL FROM session. Minimum: 100

#
# SPF support options (see http://spf.pobox.com/)
# Zmailer needs to be compiled with libspf_alt
# (see http://www.midwestcs.com/spf/libspf-alt/)
#
#PARAM spf-localpolicy  "ip4:1.2.3.4/24 ?exists:%{ir}.trusted-forwarders.domain.com"
#                       # SPF localpolicy (see libspf2 documentation)
#PARAM spf-whitelist-use-default  false
#                       # use (true) or not use (false) default whitelist
#                       # (see libspf2 documentation)
#
#
#PARAM spf-received     # Create Received-SPF header if SPF check is
#                       # done and data is available.
#
#PARAM spf-threshold  softfail    # worst acceptable SPF check result
#                       # 'fail' - always accept
#                       # 'softfail' - accept if 'softfail',
#                       #   'unpublished', 'neutral', 'pass'
#                       # 'none' - treat 'softfail' as 'fail'
#                       #   accept all better results
#                       # 'neutral' - reject unpublished
#                       # 'pass' - accept only 'pass' and
#                       #   DNS errors.
#      See http://spf.pobox.com/ for more explanation of SPF.
#
# Enablers of some commands:
#PARAM  DEBUGcmd
#PARAM  EXPNcmd
#PARAM  VRFYcmd
#
# Matching disablers (original default state)
#PARAM  no-DEBUGcmd
#PARAM  no-EXPNcmd
#PARAM  no-VRFYcmd
#
#PARAM  smtp-auth-sasl
#       # Authentication with SASL[2] mechanisms
#       # in the system.  Enabling this takes
#       # precedence over smtp-auth below!
#
#PARAM  sasl-mechanisms  "LIST OF SASL MECHANISMS"
#       # A quoted space delimittered list of SASL-
#       # mechanisms we want to support.
#       # Possibly just: "plain" !
#
#PARAM  smtp-auth
#       # Enable, if you want to allow SMTP to autenticate
#       # with the default code against system  /etc/passwd
#       # (or whatever source  getpwnam() uses for it..)
#       # This is intended to be used WITH the TLS network
#       # encryption!  This supports just plaintext logins.
#
#PARAM  auth-failrate 20
#       # Limit number of failed SMTP AUTHs per hour per IP
#       # to this number, above this, and all AUTHs will
#       # always fail... (Anti-oracle machinery.)
#
#PARAM  no-smtp-auth-on-port-25
#       # No "AUTH LOGIN"/"AUTH=LOGIN" on port 25, which
#       # appears to be troublesome to many users.
#       # This allows authentication in SUBMISSION, though.
#
#PARAM smtp-auth-username-prompt "Username:"
#PARAM smtp-auth-password-prompt "Password:"
#       # Define text prompts for builtin hard-coded
#       # AUTH LOGIN processing.  Most clients don't
#       # show any of these to the users  :-(
#
#PARAM  SMTP-auth-pipe /path/to/program
#       # External authentication program. The
#       # authenticator should read a username from
#       # command line and a password from standard input.
#       # Exit status 0 means successful authentication.
#       # Works only without SASL
#
#PARAM  AUTH-LOGIN-also-without-TLS
#       # Enable, if the "AUTH LOGIN" must be allowed to
#       # be used without running under SSL/TLS encryption
#       # envelope.   Plain-text authentications should
#       # not be used, but you are probably using them
#       # at POP3 and IMAP services, anyway...
#
#PARAM  use-tcp-wrapper
#       # If TCP-WRAPPER is configured in, uncommenting this
#       # will activate its use to look service name: smtp-receiver
#
# Disablers of some facility adverticements/supports:
#
#PARAM  NoEHLO
#PARAM  NoPIPELINING
#PARAM  No8BITMIME
#PARAM  NoCHUNKING
#PARAM  NoDSN
#PARAM  NoETRN
#
# Matching re-enabler, if default-group got disabled:
#PARAM EHLO-OK
#PARAM PIPELINING-OK
#PARAM 8BITMIME-OK
#PARAM CHUNKING-OK
#PARAM DSN-OK
#PARAM ETRN-OK

PARAM   no-multiline-replies # except to EHLO (Bloody M$ RFC821/AppE violators)
#PARAM  multiline-replies-ok # except to EHLO (Bloody M$ RFC821/AppE violators)

#PARAM   force-rcpt-notify-never
#     # Some want to hide the delivery knowledge.
#PARAM   no-force-rcpt-notify-never
#     # invert previous, default
#
#
# Final message for SMTP rejects.  You can put a pointer to your policy
# web page or such things.
#PARAM contact-pointer-message "Ask HELP for our contact information."
#
#
# The policy database:  (NOTE: See  'makedb'  for its default suffixes!)
#
PARAM  policydb        $DBTYPE  $MAILVAR/db/smtp-policy
#
# External program for received message content analysis:
#PARAM  contentfilter   $MAILBIN/smtp-contentfilter
#PARAM  contentfilter-maxpar 2  # Max parallel content filters; 1 .. 20
#PARAM  debug-contentfilter # Debug the content-filter interface protocol

#
#PARAM  tarpit 0 0 0   # No "tarpit" for 4XX/5XX reply codes (default)
#PARAM  tarpit 20 0.1 300  # Initial delay: 20 secs, next = prev + (prev * 0.1)

#
# TLSv1/SSLv[23] parameters; all must be used for the system to work!
#
# See  doc/guides/openssl,  or:
# http://www.aet.tu-cottbus.de/personen/jaenicke/pfixtls/doc/setup.html
#
#PARAM use-tls     # enable to serve STARTTLS
#PARAM no-use-tls  #(default)
#
#PARAM outlook-tls-bug
#     # Fix problems when with Outlook is talking to SUBMIT port
#
#PARAM  tls-CAfile      $MAILVAR/db/smtpserver-CAcert.pem
#PARAM  tls-cert-file   $MAILVAR/db/smtpserver-cert.pem
#PARAM  tls-key-file    $MAILVAR/db/smtpserver-key.pem
#
#  # If system default SSL-session-cache is to be used ?
#PARAM  tls-use-scache
#PARAM  tls-scache-name "zzz"
#PARAM  tls-scache-timeout 3600 # (cache timeout in seconds)
#
#  # Then some futher thoughs that may materialize some time..
#PARAM tls-loglevel     0
#PARAM tls-ccert-vd     0
#PARAM tls-ask-cert     0
#PARAM tls-require-cert 0
##PARAM tls-CApath ... (somewhen: ways to verify client's certificates)
##PARAM tls-enforce-tls 1

# Elements to be added into "Received:" header's initial comment part:
#
#PARAM rcvd-ident       # The ident lookup result (or even admitting it)
#PARAM rcvd-whoson      # Likewise for "whoson"
#PARAM rcvd-auth-user   # Authenticated Username
#PARAM rcvd-tls-mode    # Cipher, or not
#PARAM rcvd-tls-peer    # Client Certificate reference
#  (plus their   no-rcvd-*  versions)


#
#PARAM report-auth-file ${MAILSHARE}/scheduler.auth
#   Defines where ACL/AUTH data for "Z-REPORT" SMTP-verb
#   is stored.
#

#
#   ### deprecated old forms of binds ###
#PARAM BindPort                   25    # Binding port
#PARAM BindAddress         [0.0.0.0]    # Binding address - for multihomers..
#PARAM BindAddress               any    # Same as [0.0.0.0]
#PARAM BindAddress              any6    # ditto for IPv6
#PARAM BindAddress       [IPv6.0::0]    # and here is for IPv6 - NO SPACES!
#PARAM BindAddress      iface:eth0:2    # Addresses of that interface
#          ###### Number of address binders is not limited!
#
#   ### preferred new forms of binds, addresses as above ###
#PARAM BindSmtp    <addr_or_if>  <optional_port>
#PARAM BindSmtpS   <addr_or_if>  <optional_port>
#PARAM BindSubmit  <addr_or_if>  <optional_port>
#          ###### Number of protocol address binders is not limited!

#PARAM newgroup
#   Begins a new group definition, and is intended to be
#   used along with service specific Binds:
#
# < at first default settings common to everything       >
# < including TLS setups, however without authentication >
# PARAM BindSmtp    any 25
#
# PARAM newgroup  #  <initiate new group>
#         # We have external hardware SSL accelerator
#         # we implement backend service for SMTPS
#         # but STARTTLS is now forbidden.
# PARAM no-use-tls
# PARAM BindSmtp    any 2501   # 
# PARAM smtp-auth  
#   <and other things needed>
#
# PARAM newgroup  #  <initiate new group>
#         # Define SMTPS service
# PARAM use-tls
# PARAM BindSmtpS    any 465   # 
# PARAM smtp-auth  
#   <and other things needed>
#
# PARAM newgroup  #  <initiate new group>
#         # Define SUBMIT service
# PARAM use-tls
# PARAM BindSubmit    any 587   # 
# PARAM smtp-auth  
#   <and other things needed>
#

#
#
# HELO/EHLO-pattern     style-flags / !reject_message
#               [max loadavg]
#
#  Note about the style-flags: 'ftve' set needs enable-router!
#    The system will not complain about lack of it (since 2.99.56),
#    but without that enable, those four flags have no effect.
#
#  List of supported style flags:
#    f     Process MAIL FROM thru the interactive router
#    t     Process RCPT TO thru the interactive router
#    v     Process VRFY thru the interactive router
#    e     Process EXPN thru the interactive router
#    R     Require always fully-qualified addresses for MAIL FROM,
#          and for RCPT TO; that is, have @ and domain.
#          ( <postmaster> is the only exception! )
#    S     Allow utter sloppyness in input syntax; mainly extra
#          white-spaces in places where they don't belong are
#          tolerated.  Also lack of HELO/EHLO greeting is allowed!
#    h     Process HELO parameter thru the interactive router
#          Use of this IS NOT RECOMMENED, but is here for the
#          completeness sake...
#    D     Don't Discard; protocol timeouts leave behind files in
#          the $POSTOFFICE/public/ directory with suffixes:
#               .SMTP-TIMEOUT   .DATA-EOF    .BDAT-EOF
#          depending on where the abort happened..
#
#localhost           * ftveR
#some.host.domain    * !NO EMAIL ACCEPTED FROM YOUR MACHINE

# If the host presents itself as:  HELO [1.2.3.4], be lenient to it..
# The syntax below is due to these patterns being SH-GLOB style patterns
# where the brackets are special characters.

#\[*\]                * ftve

# Per default demand strict syntactic adherence, including fully
# qualified addresses for  MAIL FROM, and RCPT TO.  To be lenient
# on that detail, remove the "R" from "veR" string below:

*                    * ftveR
