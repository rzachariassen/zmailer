#
# Scheduler configuration file
#
# The scheduler reads this file on startup or when it receives a SIGUSR1 signal
#
# Every channel/host combination in recipient addresses will be sifted through
# the clauses matched in this file, picking up parameters until a clause that
# specifies a command.  Everything is free-form with three requirements:
# Clauses (i.e. the channel/host pattern) start at the beginning of a line.
# Clause contents (i.e. the parameters) don't.
# Components are separated by whitespace.
# NB! For command paths, the "current directory" is MAILBIN/ta

# Boilerplate default parameters
*/*	interval=1m
	idlemax=2m
	# expire messages after 3 days without full delivery
	expiry=2d
	# when the scheduler gets to the end of the retry sequence,
	# it starts over at some random point in the middle.  The
	# numbers are factors of the scheduling interval.
	retries="1 1 2 3 5 8 13 21 34"
	# no default limits on simultaneous transport agents or
	# connections to a particular host
	maxchannel=0
	maxring=20
	#
	maxta=250 # OSF/1 has 4096 files per process. Don't overbook :-)
	#
	# skew is maximum number of tries before the retry time is
	# aligned to a standard boundary (seconds modulo interval).
	skew=1
	# default uid/gid of transport agents
	user=root
	group=daemon
	#
	# A flag telling about queue-order..
	#
	ageorder
	overfeed=150


# Deferred delivery is handled by this transport agent.  Deferrals are low
# priority, but they tend to bunch up.  The 1 channel slot means there will
# be lots of contention, and typical checking intervals will be a bit higher
# than what is specified (due to waiting for a free slot).
hold/*
	interval=5m
	maxchannel=1
	command=hold

# BITNET delivery methods

defrt1/*
	maxchannel=3
	command="sm -c $channel defrt1"

bsmtp3/*
	maxchannel=3
	command="sm -c $channel bsmtp3"

bsmtp3nd/*
	maxchannel=3
	command="sm -c $channel bsmtp3nd"
bsmtp3rfc/*
	maxchannel=3
	command="sm -c $channel bsmtp3"

bsmtp3ndrfc/*
	maxchannel=3
	command="sm -c $channel bsmtp3nd"

# Local delivery: user mail, files, processes
local/*
	interval=60s
	idlemax=90s
	expiry=3h
	# want 20 channel slots, but only one HOST
	maxchannel=10
	maxring=5
	#
	# Do MIME text/plain; Quoted-Printable -> text/plain; 8BIT
	# conversion on flight!
	command="mailbox -8"

# This is a FAST EXPIRY test case.. Will always cause bounce, btw..
smtp/*-gw.funet.fi
	maxchannel=0
	maxring=5
	expiry=1m
	interval=15s
	retries="1"
	skew=1
	command="smtp -sl /var/log/mail/smtp"
smtp/avocado.funet.fi
	maxchannel=0
	maxring=2
	expiry=5m
	command="smtp -sl /var/log/mail/smtp"

smtp/*.rutgers.edu
	maxchannel=199
	maxring=10
	command="smtp -sl /var/log/mail/smtp"
smtp/*.edu
	maxchannel=199
	maxring=20
	command="smtp -sl /var/log/mail/smtp"
smtp/*.com
	maxchannel=199
	maxring=30
	command="smtp -sl /var/log/mail/smtp"
smtp/*.uk
	maxchannel=199
	maxring=8
	command="smtp -sl /var/log/mail/smtp"
smtp/*.ca
	maxchannel=199
	maxring=10
	command="smtp -sl /var/log/mail/smtp"
smtp/*.se
	maxchannel=199
	maxring=7
	command="smtp -sl /var/log/mail/smtp"
smtp/*.dk
	maxchannel=199
	maxring=7
	command="smtp -sl /var/log/mail/smtp"
smtp/*.is
	maxchannel=199
	maxring=5
	command="smtp -sl /var/log/mail/smtp"
smtp/*.no
	maxchannel=199
	maxring=7
	command="smtp -sl /var/log/mail/smtp"
smtp/*.de
	maxchannel=199
	maxring=10
	command="smtp -sl /var/log/mail/smtp"
smtp/*.uk
	maxchannel=199
	maxring=10
	command="smtp -sl /var/log/mail/smtp"
smtp/*.gov
	maxchannel=199
	maxring=5
	command="smtp -sl /var/log/mail/smtp"
smtp/*.mil
	maxchannel=199
	maxring=5
	command="smtp -sl /var/log/mail/smtp"
smtp/*.net
	maxchannel=199
	maxring=10
	command="smtp -sl /var/log/mail/smtp"
smtp/*.org
	maxchannel=199
	maxring=10
	command="smtp -sl /var/log/mail/smtp"

# Within FUNET we have a bit longer expiry..
smtp/*funet.fi
	maxchannel=199
	maxring=9
	# maxta=2
	interval=10m
	retries="1 1 2 3 5 8 13 21 34"
	skew=1
	# Do FORCED MIME-decoding into C-T-E: 8BIT
	command="smtp -8sl /var/log/mail/smtp"

# Within our organization we care more about speed and capacity than connections
# The maxchannel value should be larger than the value used by smtp/*, to avoid
# some potential state and phase problems in the queues.
smtp/*.fi
	maxchannel=199
	maxring=20
	interval=10m
	retries="1 1 2 3 5 8 13 21 34"
	skew=1
	command="smtp -sl /var/log/mail/smtp"

# Connections to the outside shouldn't duplicate effort so we only allow one
# per destination.
smtp/*
	maxchannel=199
	maxring=50
	command="smtp -sl /var/log/mail/smtp"

# Error messages.  Delivery can be retried at leisure.
error/*
	interval=5m
	idlemax=2m
	maxchannel=5
	command=errormail

# UUCP delivery.  The "sm" transport agent picks the first host it sees and
# will select further recipient addresses with that host only.  We tell
# the scheduler this with the "byhost" boolean, to avoid a staggered delivery
# effect if the scheduler has to discover this on its own.
uucp/*		maxchannel=5
		command="sm -8c $channel uucp"

# News delivery.  Hostname is always the same here.
usenet/*	maxchannel=2
		command="sm -8c $channel usenet"

# UBC EAN X.400 gateway.  See comment at UUCP.
ean/*		maxchannel=1
		command="sm -c $channel ean"
