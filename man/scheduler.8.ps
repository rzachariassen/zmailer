%!PS-Adobe-3.0
%%Creator: groff version 1.16
%%CreationDate: Sun Nov 19 17:15:48 2000
%%DocumentNeededResources: font Times-Roman
%%+ font Times-Bold
%%+ font Times-Italic
%%DocumentSuppliedResources: procset grops 1.16 0
%%Pages: 15
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.16 0
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
/Times-Roman@0 ENC0/Times-Roman RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R/F1
10.95/Times-Bold@0 SF -.219(NA)72 84 S(ME).219 E F0
(scheduler \255 zmailer transport queue scheduler daemon)108 96 Q F1
(SYNOPSIS)72 112.8 Q/F2 10/Times-Bold@0 SF(scheduler)108 124.8 Q F0([)
3.244 E F2(\255di)3.244 E(vFHnQSVW)-.1 E F0 3.244(][)3.244 G F2<ad66>A
/F3 10/Times-Italic@0 SF(con\214g\214le)3.244 E F0 3.244(][)3.244 G F2
.744(\255E newentsmax)B F0 3.244(][)3.244 G F2<ad4c>A F3(lo)3.244 E
(g\214le)-.1 E F0 3.244(][)3.244 G F2<ad6c>A F3(statisticslo)3.243 E(g)
-.1 E F0 3.243(][)3.243 G F2<ad4e>A F3(tr)108 136.8 Q(anspmaxfno)-.15 E
F0 2.5(][)2.5 G F2<ad50>A F3(postof)2.5 E(\214ce)-.18 E F0 2.5(][)2.5 G
F2<ad70>A F3 -.15(ch)2.5 G(annel/host-pair).15 E F0 2.5(][)2.5 G F2
<ad52>A F3(maxforkfr)2.5 E(eq)-.37 E F0 2.5(][)2.5 G F2<ad71>A F3 -.37
(re)2.5 G(ndezvous).37 E F0(])2.5 E F1(DESCRIPTION)72 153.6 Q F0(The)108
165.6 Q F3(sc)2.5 E(heduler)-.15 E F0(daemon manages the deli)2.5 E -.15
(ve)-.25 G(ry processing of messages in ZMailer).15 E(.)-.55 E(The)108
182.4 Q F3 -.45(ro)3.621 G(uter).45 E F0 1.121
(\(8\) creates message control \214les in the).73 F F3(POST)3.622 E
(OFFICE)-.18 E F2(/transport)A F0(directory)3.622 E 6.122(.T)-.65 G
1.122(hese refer to the)-6.122 F(original message \214les in the)108
194.4 Q F3(POST)2.5 E(OFFICE)-.18 E F2(/queue)A F0(directory)2.5 E(.)
-.65 E(The)108 211.2 Q F3(sc)2.54 E(heduler)-.15 E F0 .039
(reads each message control \214le from)2.54 F F3(POST)2.539 E(OFFICE)
-.18 E F2(/transport)A F0 2.539(,t)C .039(ranslates the contained mes-)
-2.539 F(sage and destination information into internal data structures\
, and unlinks the message control \214le.)108 223.2 Q 2.037
(Based on scheduling, priority)108 240 R 4.537(,a)-.65 G 2.038(nd e)
-4.537 F -.15(xe)-.15 G 2.038
(cution information read from a con\214guration \214le, the).15 F F3(sc)
4.538 E(heduler)-.15 E F0(arranges to e)108 252 Q -.15(xe)-.15 G(cute T)
.15 E(ransport Agents rele)-.35 E -.25(va)-.25 G
(nt to the queued messages.).25 E .68
(At the time scheduled for a particular transport agent in)108 268.8 R
-.2(vo)-.4 G .68(cation, the).2 F F3(sc)3.18 E(heduler)-.15 E F0 .68
(will start a transport agent)3.18 F .034(\(or use one from idle-pool\)\
, and tell it one by one which message control \214les to process.)108
280.8 R .034(When all the des-)5.034 F .986
(tination addresses in a message ha)108 292.8 R 1.286 -.15(ve b)-.2 H
.986(een processed, the).15 F F3(sc)3.486 E(heduler)-.15 E F0 .986
(performs error reporting tasks if an)3.486 F -.65(y,)-.15 G 1.984
(and then deletes the message control \214le in)108 304.8 R F3(POST)
4.484 E(OFFICE)-.18 E F2(/transport)A F0 1.985
(and the original message \214le in)4.484 F F3(POST)108 316.8 Q(OFFICE)
-.18 E F2(/queue)A F0(.)A .486(All message deli)108 333.6 R -.15(ve)-.25
G .486(ry is actually performed by T).15 F .485
(ransport Agents, which are declared in a con\214guration \214le)-.35 F
1.971(for the)108 345.6 R F3(sc)4.471 E(heduler)-.15 E F0 6.971(.E).73 G
1.971(ach transport agent is e)-6.971 F -.15(xe)-.15 G 1.972
(cuted with the same current directory as the).15 F F3(sc)4.472 E
(heduler)-.15 E F0(.).73 E F3(sc)108 357.6 Q(heduler)-.15 E F0<ad>.73 E
F3(tr).13 E(ansporter)-.15 E F0
(interaction protocol is described latter in this man-page.)2.5 E .157(\
The standard output of each transport agent are destination address del\
i)108 374.4 R -.15(ve)-.25 G .156(ry reports; either successful deli).15
F(v-)-.25 E(ery)108 386.4 Q 3.135(,u)-.65 G .635(nsuccessful deli)-3.135
F -.15(ve)-.25 G(ry).15 E 3.135(,o)-.65 G 3.135(rd)-3.135 G .635
(eferral of the address.)-3.135 F .636(Each report uses byte of)5.636 F
.636(fsets in the message control)-.25 F .307
(\214le to refer to the address.)108 398.4 R .306
(Reports may also include a comment line which will be displayed in the)
5.307 F F3(sc)2.806 E(hed-)-.15 E(uler)108 410.4 Q F0 1.1 -.55('s o).73
H(wn reports.).3 E -1 -.8(Tw o)108 427.2 T
(types of reports are produced:)3.3 E 26(1. Error)108 444 R .345
(messages caused by unsuccessful deli)2.845 F -.15(ve)-.25 G .345
(ry of a message are appended to its message control).15 F 3.187
(\214le. Occasionally)144 456 R 3.187(,f)-.65 G .687(or e)-3.187 F .687
(xample, when all addresses ha)-.15 F .987 -.15(ve b)-.2 H .686
(een processed, the).15 F F3(sc)3.186 E(heduler)-.15 E F0(generates)
3.186 E(an error message to the error return address of the message \(u\
sually the original sender\).)144 468 Q 26(2. The)108 484.8 R F3(sc)
2.752 E(heduler)-.15 E F0 .252(binds itself to a well-kno)2.752 F .253
(wn TCP/IP port \()-.25 F F2(MAILQ)A F0 2.753(,T)C .253
(CP port 174\) on startup.)-2.753 F(An)5.253 E(y)-.15 E 1.168(connectio\
ns to this port are processed synchronously in the scheduler at points \
in the e)144 496.8 R -.15(xe)-.15 G(cution).15 E 1.06
(where the state is internally consistent.)144 508.8 R(The)6.061 E F3
(sc)3.561 E(heduler)-.15 E F0 1.061
(simply dumps its internal state in a terse)3.561 F .007
(format to the TCP stream.)144 520.8 R .006(It is e)5.006 F .006
(xpected that the client program will reconstruct the data structures)
-.15 F(suf)144 532.8 Q 1.565(\214ciently to gi)-.25 F 1.866 -.15(ve a u)
-.25 H 1.566(ser a good idea of what the scheduler thinks the w).15 F
1.566(orld looks lik)-.1 F 4.066(e. The)-.1 F F3(mailq)144 544.8 Q F0
(\(1\) program serv).33 E(es this purpose.)-.15 E F1(OPTIONS)72 561.6 Q
F0(In)108 573.6 Q -.2(vo)-.4 G(king).2 E F3(sc)2.5 E(heduler)-.15 E F0
(without an)2.5 E 2.5(ya)-.15 G -.18(rg)-2.5 G
(ument will start it as a daemon.).18 E 22.86(\255d run)108 590.4 R
(as a daemon, usually used after \255v to log daemon acti)2.5 E
(vity in great detail.)-.25 E<ad45>108 607.2 Q F3(ne)2.5 E(wentsmax)-.15
E F0 .178(when globbing ne)144 619.2 R 2.678(wt)-.25 G .178
(asks from the directory)-2.678 F 2.677(,p)-.65 G .177
(ick only \214rst `)-2.677 F(`ne)-.74 E(wentsmax')-.25 E 2.677('o)-.74 G
2.677(ft)-2.677 G .177(hem, and lea)-2.677 F .477 -.15(ve r)-.2 H(est)
.15 E(for a ne)144 631.2 Q 2.5(ws)-.25 G(can run.)-2.5 E<ad66>108 648 Q
F3(con\214g\214le)2.5 E F0 -.15(ove)144 660 S(rrides the def).15 E
(ault con\214guration \214le)-.1 E F3(MAILSHARE)2.5 E F2(/scheduler)A
(.cf)-1 E F0(.)A 22.3(\255F Freeze)108 676.8 R(-- don')2.5 E 2.5(ta)-.18
G(ctually run an)-2.5 E(ything, just do queue scanning.)-.15 E(\(F)5 E
(or deb)-.15 E(ug purposes..\))-.2 E(\255H \255HH)108 693.6 Q 1.47
(Use multi-le)144 705.6 R -.15(ve)-.25 G 3.97(lh).15 G 1.47
(ashing at the spool directories.)-3.97 F 1.47(This will ef)6.47 F 1.47
(\214ciently reduce the lengths of the)-.25 F .675
(scans at the directories to \214nd some arbitary \214le in them.)144
717.6 R .674(One `H' means "single le)5.674 F -.15(ve)-.25 G 3.174(lh)
.15 G(ashing",)-3.174 E(tw)144 729.6 Q 4.476(o`)-.1 G(HH')-4.476 E 4.476
(sm)-.55 G 1.976(ean "dual le)-4.476 F -.15(ve)-.25 G 4.476(lh).15 G
4.476(ashing". `)-4.476 F(`Hash')-.74 E 4.476('i)-.74 G 4.476(sd)-4.476
G 1.977(irectory which name is single upper case)-4.476 F(17 No)279.965
768 Q 2.5(v2)-.15 G 200.465(000 1)-2.5 F EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R
(alphabet \(A-Z\).)144 84 Q(When e)144 108 Q(xisting, ZENV v)-.15 E
(ariable)-.25 E/F1 10/Times-Italic@0 SF(SCHEDULERDIRHASH)2.5 E F0 -.15
(ove)2.5 G(rrides the `H' option.).15 E 25.08(\255i run)108 124.8 R
(interacti)2.5 E -.15(ve)-.25 G(ly).15 E 2.5(,i)-.65 G
(.e., not as a daemon.)-2.5 E<ad4c>108 141.6 Q F1(lo)2.5 E(g\214le)-.1 E
F0 -.15(ove)144 153.6 S(rrides the def).15 E(ault log \214le location)
-.1 E F1(LOGDIR)2.5 E/F2 10/Times-Bold@0 SF(/scheduler)A F0(.)A<ad6c>108
170.4 Q F1(statisticslo)2.5 E(g)-.1 E F0 1.453
(starts the appending of deli)144 182.4 R -.15(ve)-.25 G 1.452
(ry statistics information \(ASCII form\) into gi).15 F -.15(ve)-.25 G
3.952<6e8c>.15 G 3.952(le. No)-3.952 F(def)3.952 E(ault)-.1 E -.25(va)
144 194.4 S(lue.).25 E(\255M [1|2])108 211.2 Q -1.11(Ve)144 223.2 S .335
(rsion of the)1.11 F F1(mailq)2.835 E F0 .335(protocol this serv)2.835 F
.335(er runs; essentially a test option, as e)-.15 F .336(xistence of)
-.15 F F1 -.9(PA)2.836 G(RAMau-).9 E(th\214le="..")144 235.2 Q F0
(assignment at the)5 E F1(sc)2.5 E(heduler)-.15 E(.conf)-1.11 E F0
(\214le turns the protocol into v)2.5 E(ersion 2.)-.15 E<ad4e>108 252 Q
F1(tr)2.5 E(ansmaxfno)-.15 E F0 1.733(sets ho)144 264 R 4.233(wm)-.25 G
(an)-4.233 E 4.232<798c>-.15 G 1.732
(lehandles are allocated for the scheduler')-4.232 F 4.232(ss)-.55 G
1.732(tarted children \(if the system has)-4.232 F
(adjustable resources.\))144 276 Q 22.86(\255n T)108 292.8 R .228
(oggles con\214guration \215ag `def)-.8 F .228
(ault_full_content', which de\214nes what will be DSN RET parameter)-.1
F(assumed v)144 304.8 Q(alue in case the originator didn')-.25 E 2.5(ts)
-.18 G(upply that parameter)-2.5 E(.)-.55 E(Def)144 328.8 Q 3.852
(ault beha)-.1 F 3.852
(viour is similar to RET=FULL, while usage of this option is equi)-.2 F
-.25(va)-.25 G 3.851(lent of).25 F 2.5(RET=HDRS. This)144 340.8 R
(option does not o)2.5 E -.15(ve)-.15 G
(rride originator supplied DSN RET parameter v).15 E(alue.)-.25 E<ad70>
108 357.6 Q F1 -.15(ch)2.5 G(annel/host).15 E F0 2.5(Ad)144 369.6 S(eb)
-2.5 E(ug-type option for running selecti)-.2 E -.15(ve)-.25 G
(ly some thread under a single instance of the).15 E F1(sc)2.5 E
(heduler)-.15 E F0(.).73 E(Use this with options: \255v)144 393.6 Q
<ad50>108 410.4 Q F1(postof)2.5 E(\214ce)-.18 E F0
(speci\214es an alternate)144 422.4 Q F1(POST)2.5 E(OFFICE)-.18 E F0
(directory)2.5 E(.)-.65 E<ad71>108 439.2 Q F1 -.37(re)2.5 G(ndezvous).37
E F0 .398(on machines without TCP/IP netw)144 451.2 R .398
(orking, the rendezv)-.1 F .398(ous between)-.2 F F1(sc)2.898 E(heduler)
-.15 E F0(and)2.899 E F1(mailq)2.899 E F0 .399(\(1\) is done).33 F 1.213
(using a well-kno)144 463.2 R 1.212(wn named pipe.)-.25 F 1.212
(This option o)6.212 F -.15(ve)-.15 G 1.212(rrides the def).15 F 1.212
(ault location for this special \214le,)-.1 F(either)144 475.2 Q F1
(RENDEZV)2.5 E(OUS)-.3 E F0(or)2.5 E F2(/usr/tmp/.mailq.text)2.5 E F0(.)
A 20.64(\255Q The)108 492 R -.74(``)2.5 G(Q').74 E('-mode, don')-.74 E
2.5(to)-.18 G(utput the old style data into the queue querier)-2.5 E 2.5
(,o)-.4 G(nly the ne)-2.5 E(w-style one.)-.25 E 22.3(\255S Synchronous)
108 508.8 R
(startup mode, scans all jobs at the directory before starting e)2.5 E
-.15(ve)-.25 G 2.5(nt).15 G(he \214rst transporter)-2.5 E(.)-.55 E 22.86
(\255v be)108 525.6 R -.15(ve)2.5 G(rbose about acti).15 E(vity)-.25 E
2.5(,a)-.65 G(nd do not detach as a daemon.)-2.5 E 18.42(\255W be)108
542.4 R 1.246(used in conjunction with \255v to delay v)3.745 F 1.246
(erbose logging start until after all the \214les ha)-.15 F 1.546 -.15
(ve b)-.2 H(een).15 E(parsed in, and it is a time for doing scheduling.)
144 554.4 Q 20.64(\255V print)108 571.2 R -.15(ve)2.5 G
(rsion message and run interacti).15 E -.15(ve)-.25 G(ly).15 E(.)-.65 E
/F3 10.95/Times-Bold@0 SF(CONFIGURA)72 588 Q(TION FILE)-1.04 E F0(The)
108 600 Q F1(sc)2.963 E(heduler)-.15 E F0 .463
(con\214guration \214le consists of a set of clauses.)2.963 F .463
(Each clause is selected by the pattern it starts)5.463 F 2.762
(with. The)108 612 R .262
(patterns for the clauses are matched, in sequence, with the)2.762 F F1
-.15(ch)2.763 G(annel).15 E F0(/).51 E F1(host).31 E F0 .263
(string for each recipient)2.763 F 3.034(address. When)108 624 R 3.034
(ac)3.034 G .533(lause pattern matches an address, the parameters set i\
n the clause will be applied to the)-3.034 F F1(sc)108 636 Q(heduler)
-.15 E F0 2.735 -.55('s p).73 H 1.635(rocessing of that address.).55 F
1.635(If the clause speci\214es a command, the clause pattern matching)
6.635 F(sequence is terminated.)108 648 Q(This is a clause:)5 E(local/*)
144 664.8 Q(interv)180 676.8 Q(al=10s)-.25 E -.15(ex)180 688.8 S
(piry=3h).15 E 2.5(#w)180 700.8 S
(ant 20 channel slots in case of blockage on one)-2.6 E(maxchannel=20)
180 712.8 Q 2.5(#w)180 724.8 S(ant 20 thread-ring slots)-2.6 E(17 No)
279.965 768 Q 2.5(v2)-.15 G 200.465(000 2)-2.5 F EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R
(maxring=20)180 84 Q(command="mailbox -8")180 96 Q 2.5(Ac)108 112.8 S
(lause consists of:)-2.5 E 2.764(\255As)144 129.6 S .264
(election pattern \(in shell style\) that is matched ag)-2.764 F .264
(ainst the)-.05 F/F1 10/Times-Italic@0 SF -.15(ch)2.764 G(annel).15 E F0
(/)A F1(host)A F0 .263(string for an address.)2.763 F 2.5(\2550o)144
146.4 S 2.5(rm)-2.5 G(ore v)-2.5 E(ariable assignments or k)-.25 E -.15
(ey)-.1 G -.1(wo).15 G(rds \(described belo).1 E(w\).)-.25 E
(There are se)108 168 Q -.15(ve)-.25 G(ral possible).15 E/F2 10
/Times-Bold@0 SF -.74(PA)2.5 G(RAM).74 E F0
(-assignments starting at column 0, more of them belo)A -.65(w.)-.25 G
.733(If the selection pattern does not contain a '/', it is assumed to \
be a channel pattern and the host pattern is)108 184.8 R
(assumed to be the wildcard '*'.)108 196.8 Q .173
(The components of a clause are separated by whitespace.)108 213.6 R
.172(The pattern introducing a clause must start in the)5.172 F .84
(\214rst column of a line, and the v)108 225.6 R .84
(ariable assignments or k)-.25 F -.15(ey)-.1 G -.1(wo).15 G .841
(rds inside a clause must not start in the \214rst).1 F .151
(column of a line.)108 237.6 R .151(This means a clause may be written \
both compactly all on one line, or spread out with an)5.151 F
(assignment or k)108 249.6 Q -.15(ey)-.1 G -.1(wo).15 G(rd per line.).1
E .569(If the clause is empty \(i.e., consists only of a pattern\), the\
n the contents of the ne)108 266.4 R .57(xt non-empty clause will)-.15 F
(be used.)108 278.4 Q
(The typical con\214guration \214le will contain the follo)108 295.2 Q
(wing clauses:)-.25 E 2.5(\255ac)144 312 S
(lause matching all addresses \(using the pattern)-2.5 E F2(*/*)2.5 E F0
2.5(\)t)C(hat sets up def)-2.5 E(ault v)-.1 E(alues.)-.25 E 2.5(\255ac)
144 328.8 S(lause matching the local deli)-2.5 E -.15(ve)-.25 G
(ry channel \(usually).15 E F2(local)2.5 E F0(\).)A 2.5(\255ac)144 345.6
S(lause matching the deferred deli)-2.5 E -.15(ve)-.25 G
(ry channel \(usually).15 E F2(hold)2.5 E F0(\).)A 2.5(\255ac)144 362.4
S(lause matching the error reporting channel \(usually)-2.5 E F2(err)2.5
E(or)-.18 E F0(\).)A 2.5<ad63>144 379.2 S
(lauses speci\214c to the other channels kno)-2.5 E(wn by the)-.25 E F1
-.45(ro)2.5 G(uter).45 E F0 2.5(,f).73 G(or e)-2.5 E(xample,)-.15 E F2
(smtp)2.5 E F0(and)2.5 E F2(uucp)2.5 E F0(.)A
(The actual names of these channels are completely controlled by the)108
396 Q F1 -.45(ro)2.5 G(uter).45 E F0(con\214guration \214le.)2.5 E(Empt\
y lines, and lines whose \214rst non-whitespace character is '#', are i\
gnored.)108 412.8 Q -1.11(Va)108 429.6 S .326(riable v)1.11 F .326
(alues may be unquoted w)-.25 F .325(ords or v)-.1 F .325
(alues or doublequoted strings.)-.25 F(Interv)5.325 E .325
(als \(delta time\) are speci-)-.25 F .653
(\214ed using a concatenation of: numbers suf)108 441.6 R<8c78>-.25 E
.653(ed with ')-.15 F .653(s', 'm', 'h', or ')-.55 F .653
(d' modi\214ers designating the number)-.5 F(as a second, minute, hour)
108 453.6 Q 2.5(,o)-.4 G 2.5(rd)-2.5 G(ay v)-2.5 E 2.5(alue. F)-.25 F
(or e)-.15 E(xample: 1h5m20s.)-.15 E(The kno)108 470.4 Q(wn v)-.25 E
(ariables and k)-.25 E -.15(ey)-.1 G -.1(wo).15 G
(rds, and their typical v).1 E(alues and semantics are:)-.25 E(interv)
108 487.2 Q(al \(1m\))-.25 E .72(speci\214es the primary retry interv)
144 499.2 R .719(al, which determines ho)-.25 F 3.219(wf)-.25 G .719
(requently a transport agent should be)-3.219 F .223
(scheduled for an address.)144 511.2 R .224(The v)5.223 F .224
(alue is a delta time speci\214cation.)-.25 F .224(This v)5.224 F .224
(alue, and the)-.25 F F1 -.37(re)2.724 G(tries).37 E F0 -.25(va)2.724 G
(lue).25 E(mentioned belo)144 523.2 Q 1.3 -.65(w, a)-.25 H
(re combined to determine the interv).65 E
(al between each retry attempt.)-.25 E(idlemax \(3x interv)108 540 Q
(al\))-.25 E .514(When a transport agent runs out of jobs, the)144 552 R
3.014(ya)-.15 G .514(re mo)-3.014 F -.15(ve)-.15 G 3.014(dt).15 G 3.014
(o`)-3.014 G .514(`idle pool')-3.754 F .513(', and it a T)-.74 F 3.013
(As)-.93 G .513(pends more)-3.013 F(than)144 564 Q F1(idlemax)2.5 E F0
(time in there, it is terminated.)2.5 E -.15(ex)108 580.8 S(piry \(3d\))
.15 E 1.756(speci\214es the maximum age of an address in the)144 592.8 R
F1(sc)4.257 E(heduler)-.15 E F0 1.757
(queue before a repeatedly deferred)4.257 F .051
(address is bounced with an e)144 604.8 R .051(xpiration error)-.15 F
5.051(.T)-.55 G .05(he actual report is produced when all addresses ha)
-5.051 F -.15(ve)-.2 G(been processed.)144 616.8 Q
(retries \(1 1 2 3 5 8 13 21 34\))108 633.6 Q .127
(speci\214es the retry interv)144 645.6 R .127(al polic)-.25 F 2.627(yo)
-.15 G 2.627(ft)-2.627 G(he)-2.627 E F1(sc)2.628 E(heduler)-.15 E F0
.128(for an address.)2.628 F .128(The v)5.128 F .128
(alue must be a sequence of)-.25 F(positi)144 657.6 Q 1.525 -.15(ve i)
-.25 H(nte).15 E 1.224
(gers, these being multiples of the primary interv)-.15 F 1.224
(al before a retry is scheduled.)-.25 F(The)6.224 E F1(sc)144 669.6 Q
(heduler)-.15 E F0 .065(starts by going through the sequence as an addr\
ess is repeatedly deferred.)2.564 F .065(When the end)5.065 F .792
(of the sequence is reached, the)144 681.6 R F1(sc)3.291 E(heduler)-.15
E F0 .791(will jump into the sequence at a random spot and con-)3.291 F
(tinue to)144 693.6 Q -.1(wa)-.25 G(rds the end.).1 E(This allo)5 E
(ws v)-.25 E(arious retry strate)-.25 E(gies to be speci\214ed easily:)
-.15 E(brute force \(or "jackhammer"\):)144 710.4 Q(retries=0)180 722.4
Q(17 No)279.965 768 Q 2.5(v2)-.15 G 200.465(000 3)-2.5 F EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R
(constant primary interv)144 84 Q(al:)-.25 E(retries=1)180 96 Q
(instant back)144 108 Q(of)-.1 E(f:)-.25 E
(retries="1 50 50 50 50 50 50 50 50 50 50 50 50")180 120 Q(slo)144 132 Q
2.5(wi)-.25 G(ncreasing \(\214bonacci\) sequence:)-2.5 E
(retries="1 1 2 3 5 8 13 21 34")180 144 Q(s-curv)144 156 Q 2.5(es)-.15 G
(equence:)-2.5 E(retries="1 1 2 3 5 10 20 25 28 29 30")180 168 Q -.15
(ex)144 180 S(ponential sequence:).15 E
(retries="1 2 4 8 16 32 64 128 256")180 192 Q(etc.)144 204 Q
(maxta \(0\))108 225.6 Q 1.299(This is)144 237.6 R/F1 10/Times-Bold@0 SF
(global)3.799 E F0 1.299(parameter limiting the number of transport-age\
nt processes that the sceduler can)3.799 F(ha)144 249.6 Q .3 -.15(ve r)
-.2 H(unning concurrently).15 E(.)-.65 E .323(If retrying an address w)
144 273.6 R .322(ould cause the number of simultaneously acti)-.1 F .622
-.15(ve t)-.25 H .322(ransport agents to e).15 F(xceed)-.15 E
(the speci\214ed v)144 285.6 Q(alue, the retry is postponed.)-.25 E .006
(When no)144 309.6 R/F2 10/Times-Italic@0 SF(maxta)2.506 E F0 .006
(parameter is used, or '0' is used, the)2.506 F F2(sc)2.506 E(heduler)
-.15 E F0 .007(\(at operating systems supporting it\))2.506 F .658
(uses getrlimit\(2\)/setrlimit\(2\) to maximize the number of a)144
321.6 R -.25(va)-.2 G .657(ilable \214le descriptors for the process.)
.25 F(The thus maximized v)144 333.6 Q
(alue minus about 20 is then used as)-.25 E F2(maxta)2.5 E F0 -.25(va)
2.5 G(lue.).25 E .072
(At some operating systems there are no bidirectional pipes or sock)144
357.6 R .073(ets for the scheduler to talk with)-.1 F .22
(the transport agents, thus at those systems each T)144 369.6 R 2.72(Ap)
-.93 G .22(rocess uses)-2.72 F F1(tw)2.72 E(o)-.1 E F2(pipe)2.72 E F0
.22(\(2\) \214le-handles, and thus).18 F(system-wide limit on)144 381.6
Q F2(maxta)2.5 E F0(halv)2.5 E(es from what w)-.15 E(as maximum deri)-.1
E -.15(ve)-.25 G 2.5(da).15 G(bo)-2.5 E -.15(ve)-.15 G(.).15 E
(maxchannel \(0\))108 410.4 Q .841(This limits the number of concurrent\
 transport agent processes for which the)144 422.4 R F2 -.15(ch)3.341 G
(annel).15 E F0 .841(part of the)3.341 F(address quad are same.)144
434.4 Q(The def)144 458.4 Q(ault v)-.1 E(alue is copied from the)-.25 E
F2(maxta)2.5 E F0(.).26 E .776(It is advisable, although not mandatory)
144 482.4 R 3.276(,t)-.65 G 3.276(oh)-3.276 G -2.25 -.2(av e)-3.276 H
.776(the same v)3.476 F .776(alue for all)-.25 F F2(maxc)3.276 E(hannel)
-.15 E F0 .776(parameters at)3.276 F
(all clauses with matching channel parts.)144 494.4 Q .137
(Case where non-alik)144 518.4 R 2.637(ev)-.1 G .137(alues might mak)
-2.887 F 2.637(es)-.1 G .137(ense is when you w)-2.637 F .138
(ant to guarantee resources for a sub-)-.1 F .107
(set of destinations, e.g. for all other "smtp/" clauses ha)144 530.4 R
-.15(ve)-.2 G F2(maxc)2.756 E(hannel)-.15 E F0 .106(of say 100, b)2.606
F .106(ut for your v)-.2 F(ery)-.15 E(important domain domain ha)144
542.4 Q .3 -.15(ve t)-.2 H(here a bit higher).15 E 2.5(,s)-.4 G
(ay: 120.)-2.5 E(maxring \(0\))108 583.2 Q .369
(The recipients are groupped into `)144 595.2 R(`threads')-.74 E 2.869
('b)-.74 G 2.869(yr)-2.869 G .369
(ecipient channel+host parts, and threads matching)-2.869 F 2.971
(same selector clause are groupped into `)144 607.2 R(`thread-rings')
-.74 E 2.971(', where same transport agent can be)-.74 F(switched o)144
619.2 Q -.15(ve)-.15 G 2.5(rf).15 G(rom one recipient to another)-2.5 E
(.)-.55 E(This parameter de\214nes ho)144 643.2 Q 2.5(wm)-.25 G(an)-2.5
E 2.5(yt)-.15 G(ransport agents can be running at an)-2.5 E 2.5(yt)-.15
G(ime at the ring.)-2.5 E(When no limit is gi)144 667.2 Q -.15(ve)-.25 G
(n, then).15 E F2(maxta)2.5 E F0 -.25(va)2.5 G(lue is used for def).25 E
(ault.)-.1 E(maxthr \(1\))108 696 Q .753(This limits the number of para\
llel transport agents within each thread; that is, using higher v)144
708 R(alue)-.25 E(than def)144 720 Q(ault `)-.1 E(`1')-.74 E 2.5('w)-.74
G(ill allo)-2.5 E 2.5(wr)-.25 G(unning more than one T)-2.5 E 2.5(Af)
-.93 G(or the jobs at the thread.)-2.5 E(17 No)279.965 768 Q 2.5(v2)-.15
G 200.465(000 4)-2.5 F EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R .533
(Do note that running more than one T)144 84 R 3.033(Ai)-.93 G 3.033(np)
-3.033 G .532(arallel may also require lo)-3.033 F .532(wering O)-.25 F
.532(VERFEED v)-.5 F(alue.)-.25 E .136(\(E.g. ha)144 96 R .136
(ving a queue of 30 messages will not bene\214t from more T)-.2 F .137
(As, unless the)-.93 F 2.637(ya)-.15 G .137(ll get something)-2.637 F
.779(to process.)144 108 R(Ha)5.779 E .779(ving O)-.2 F .779
(VERFEED per def)-.5 F .779
(ault at 150 will essentially feed whole queue to one T)-.1 F(A,)-.93 E
(others are not getting an)144 120 Q -.65(y.)-.15 G(\)).65 E -.15(ove)
108 148.8 S(rfeed \(150\)).15 E .374
(Because the scheduler spins around a bit sluggishly to spot acti)144
160.8 R .675 -.15(ve T)-.25 H .375(As, it does mak)-.78 F 2.875(es)-.1 G
.375(ense to feed)-2.875 F .341(more than one task to a T)144 172.8 R
.341(A, and then w)-.93 F .34
(ait for the results, thus came about the `)-.1 F(`o)-.74 E -.15(ve)-.15
G(rfeed').15 E 2.84('m)-.74 G(echa-)-2.84 E(nism.)144 184.8 Q
(This tells ho)144 208.8 Q 2.5(wm)-.25 G(an)-2.5 E 2.5(yj)-.15 G
(ob speci\214ers to feed to the T)-2.5 E 2.5(Aw)-.93 G(hen the T)-2.5 E
2.5(Ap)-.93 G(rocess state is `)-2.5 E(`STUFFING.)-.74 E -.74('')-.7 G
(sk)108 237.6 Q .5 -.25(ew \()-.1 H(5\)).25 E(Lefto)144 249.6 Q -.15(ve)
-.15 G 2.5(rf).15 G(rom earlier scheduler internal structure.)-2.5 E
(Does not mak)5 E 2.5(es)-.1 G(ense an)-2.5 E(ymore.)-.15 E
(user \(root\))108 278.4 Q .231
(is the user id of a transport agent processing the address.)144 290.4 R
.231(The v)5.231 F .231(alue is either numeric \(a uid\) or an)-.25 F
(account name.)144 302.4 Q(group \(daemon\))108 331.2 Q .143
(is the group id of a transport agent processing the address.)144 343.2
R .143(The v)5.143 F .143(alue is either numeric \(a gid\) or a)-.25 F
(group name.)144 355.2 Q(command \(smtp -srl ${LOGDIR}/smtp $host\))108
384 Q(is the command line used to start a transport agent to process th\
e address.)144 396 Q(The program pathname is speci\214ed relati)144 420
Q .3 -.15(ve t)-.25 H 2.5(ot).15 G(he)-2.5 E/F1 10/Times-Italic@0 SF
(MAILBIN)2.5 E/F2 10/Times-Bold@0 SF(/ta)A F0(directory)2.5 E(.)-.65 E
.688(The string "$channel" is replaced by the current matched channel, \
and "$host" is replaced by the)144 444 R .297(current matched host, fro\
m the destination address, and "${LOGDIR}" substitutes ZENV v)144 456 R
(ariable)-.25 E(LOGDIR v)144 468 Q(alue there.)-.25 E F1 .008(It is str)
144 492 R .008(ongly r)-.45 F .008(ecommended that the $host is not to \
be used on a command de\214nition, as it limits the)-.37 F
(usability of idled tr)144 504 Q(ansporter)-.15 E(.)-1.11 E F0
(queueonly)108 532.8 Q 3.835(ac)144 544.8 S 1.335(lause with)-3.835 F F1
(queueonly)3.834 E F0 1.334(\215ag does not auto-start at the arri)3.834
F -.25(va)-.25 G 3.834(lo).25 G 3.834(fam)-3.834 G 1.334
(essage, instead it)-3.834 F F2(must)3.834 E F0(be)3.834 E
(started by means of)144 556.8 Q F1(smtpserver)2.5 E F0(\(8\) command)
.73 E F2(ETRN)2.5 E F0(thru an SMTP connection.)2.5 E 4.056 -.8(To h)144
580.8 T -2.25 -.2(av e).8 H 2.456(message e)5.156 F 2.456(xpiration w)
-.15 F 2.456(orking, follo)-.1 F 2.456
(wing additional entries are suggested:)-.25 F F1(interval=1h)4.956 E
-.37(re)144 592.8 S(tries="24").37 E F0 -.15(Fo)108 621.6 S 2.5(re).15 G
(xample, this is a complete con\214guration \214le:)-2.65 E 2.5(#D)144
638.4 S(ef)-2.5 E(ault v)-.1 E(alues)-.25 E(*/*)144 650.4 Q(interv)180
662.4 Q(al=1m e)-.25 E(xpiry=3d retries="1 1 2 3 5 8 13 21 34")-.15 E
(maxring=0 maxta=0 sk)180 674.4 Q -.25(ew)-.1 G
(=5 user=root group=daemon).25 E 2.5(#B)144 686.4 S
(oilerplate parameters for local deli)-2.5 E -.15(ve)-.25 G
(ry and service channels).15 E(local/*)144 698.4 Q(interv)180 710.4 Q
(al=10s e)-.25 E(xpiry=3h maxchannel=2 command=mailbox)-.15 E(error)144
722.4 Q(17 No)279.965 768 Q 2.5(v2)-.15 G 200.465(000 5)-2.5 F EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R
(interv)180 84 Q(al=5m maxchannel=10 command=errormail)-.25 E(hold/*)144
96 Q(interv)180 108 Q(al=5m maxchannel=1 command=hold)-.25 E 2.5(#M)144
120 S(iscellaneous channels supported by router con\214guration)-2.5 E
(smtp/*.toronto.edu)144 132 Q(smtp/*.utoronto.ca)144 144 Q
(maxchannel=10 maxring=2)180 156 Q(command="smtp -srl $LOGDIR/smtp")180
168 Q(smtp)144 180 Q(maxchannel=10 maxring=5)180 192 Q
(command="smtp -esrl $LOGDIR/smtp")180 204 Q(uucp/*)144 216 Q
(maxchannel=5 command="sm -c $channel uucp")180 228 Q .274
(The \214rst clause \(*/*\) sets up def)108 256.8 R .274(ault v)-.1 F
.274(alues for all addresses.)-.25 F .273
(There is no command speci\214cation, so clause)5.273 F
(matching will continue after address ha)108 268.8 Q .3 -.15(ve p)-.2 H
(ick).15 E(ed up the parameters set here.)-.1 E 1.494(The third clause \
\(error\) has an implicit host wildcard of '*', so it w)108 297.6 R
1.494(ould match the same as specifying)-.1 F(error/* w)108 309.6 Q
(ould ha)-.1 E -.15(ve)-.2 G(.).15 E .32(The \214fth clause \(smtp/*.to\
ronto.edu\) has no further components so it selects the components of t\
he follo)108 338.4 R(w-)-.25 E(ing non-empty clause \(the sixth\).)108
350.4 Q 2.521(Both the \214fth and sixth clauses are speci\214c to addr\
ess destinations within the T)108 379.2 R(OR)-.18 E(ONT)-.4 E 2.522
(O.EDU and)-.18 F(UT)108 391.2 Q(OR)-.18 E(ONT)-.4 E .83(O.CA or)-.18 F
-.05(ga)-.18 G .83(nization \(the tw).05 F 3.33(oa)-.1 G .829
(re parallel domains\).)-3.33 F .829(At most 10 deli)5.829 F -.15(ve)
-.25 G .829(ries to the).15 F/F1 10/Times-Bold@0 SF(smtp)3.329 E F0
(channel)3.329 E .531(may be concurrently acti)108 403.2 R -.15(ve)-.25
G 3.031(,a).15 G .532(nd at most 2 for all possible hosts within T)
-3.031 F(OR)-.18 E(ONT)-.4 E 3.032(O.EDU. If)-.18 F .532($host is men-)
3.032 F .839(tioned in the command speci\214cation, the transport agent\
 will only be told about the message control \214les)108 415.2 R 1.474
(that indicate SMTP deli)108 427.2 R -.15(ve)-.25 G 1.474
(ry to a particular host.).15 F 1.474(The actual host is pick)6.474 F
1.474(ed at random from the current)-.1 F(choices, to a)108 439.2 Q -.2
(vo)-.2 G(id systematic errors leading to a deadlock of an).2 E 2.5(yq)
-.15 G(ueue.)-2.5 E/F2 10.95/Times-Bold@0 SF(CONFIGURA)72 468 Q
(TION FILE P)-1.04 E(ARAM-ASSIGNMENTS)-.81 E F0 .076
(The scheduler can assign se)108 480 R -.15(ve)-.25 G .076
(ral of its internal parameters by ha).15 F .076(ving v)-.2 F .076
(ariable assignments be)-.25 F .076(ginning at col-)-.15 F
(umn 0, and be)108 492 Q(ginning with "P)-.15 E(ARAM" te)-.92 E(xt:)-.15
E -.92(PA)108 520.8 S(RAMmailqpath = "UNIX:/path/to/pf_unix/mailq/sock)
.92 E(et")-.1 E -.92(PA)108 537.6 S(RAMmailqpath = "TCP:mailq").92 E
-.92(PA)108 554.4 S(RAMmailqpath = "TCP:174").92 E 1.527
(These de\214ne tw)144 566.4 R 4.027(od)-.1 G(if)-4.027 E 1.527
(ferent types of possible sock)-.25 F 1.527(et addresses for the)-.1 F
1.528(mailq protocol; a UNIX)8.056 F(sock)144 578.4 Q
(et, and a TCP sock)-.1 E 2.5(et. Def)-.1 F(ault is "TCP:174".)-.1 E
-.92(PA)108 607.2 S(RAMaut\214le = "/path/to/scheduler).92 E(.auth")-.55
E(Location of MAILQv2 autentication control \214le)144 619.2 Q -.92(PA)
108 636 S(RAMglobal-report-interv).92 E(al = 15m)-.25 E(Interv)144 648 Q
1.286(al by which all permanent reports accumulated into a message are \
reported by; sends out)-.25 F .781(early reports of deli)144 660 R -.15
(ve)-.25 G .782(ry f).15 F .782(ailures, and does not force to w)-.1 F
.782(ait for maximum queue timeout in case)-.1 F
(the message has more than once recipient.)144 672 Q F2(MESSA)72 700.8 Q
(GE CONTR)-.602 E(OL FILE SYNT)-.329 E(AX)-.986 E F0 3.885(Am)108 712.8
S 1.385
(essage control \214le contains all the information needed by deli)
-3.885 F -.15(ve)-.25 G 1.384(ry programs lik).15 F(e)-.1 E/F3 10
/Times-Italic@0 SF(sc)3.884 E(heduler)-.15 E F0 1.384(and the)3.884 F
1.897(transport agents.)108 724.8 R 1.897
(It is a terse presentation of the)6.897 F F3 -.45(ro)4.397 G(uter).45 E
F0 2.997 -.55('s d).73 H 1.898
(ecisions, along with some useful reference).55 F(17 No)279.965 768 Q
2.5(v2)-.15 G 200.465(000 6)-2.5 F EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R
(information.)108 84 Q
(The message control \214le consists of a number of \214elds.)108 112.8
Q .632(All \214elds start in the \214rst column \(i.e., at the be)108
136.8 R .631(ginning of the \214le or just after a ne)-.15 F .631
(wline\), and most \214elds)-.25 F -.15(ex)108 148.8 S .617
(tend to the end of line.).15 F .617(The one e)5.617 F .617
(xception is the message header \214eld which e)-.15 F .618
(xtends till a double-ne)-.15 F(w-)-.25 E(line terminator)108 160.8 Q(.)
-.55 E -.15(Fo)108 184.8 S 2.836(ra).15 G .336(ll b)-2.836 F .336
(ut this message header \214eld, the second column is reserv)-.2 F .335
(ed for a tag byte.)-.15 F .335(This position is used to)5.335 F .026(l\
ock the \214eld and to indicate the status of past processing of the \
\214eld.)108 196.8 R -.15(Fo)5.026 G 2.526(re).15 G .026
(xample, the success or f)-2.676 F .026(ailure of)-.1 F(deli)108 208.8 Q
-.15(ve)-.25 G .579(ry to a recipient address is indicated by a '+' or \
means the \214eld has not been processed, or that pro-).15 F .244
(cessing has been deferred.)108 220.8 R 2.744(A')5.244 G .244
(~' indicates the \214eld is lock)-2.744 F .244
(ed because some transport agent is currently pro-)-.1 F(cessing deli)
108 232.8 Q -.15(ve)-.25 G(ry for the address.).15 E(The kno)5 E
(wn \214eld names and tags are de\214ned in)-.25 E/F1 10/Times-Bold@0 SF
(<mail.h>)2.5 E F0(.)A -.15(Fo)108 256.8 S 3.376(ra).15 G .876(ll the)
-3.376 F/F2 10/Times-Italic@0 SF -.37(re)3.376 G(cipient).37 E F0 .876(\
addresses, there is 6 characters space for transport-agent process-id s\
o that a quickly)3.376 F(restarted scheduler will not do double-deli)108
268.8 Q -.15(ve)-.25 G(ry on some slo).15 E(wly running transporter)-.25
E(.)-.55 E(The follo)108 297.6 Q(wing \214elds are mandatory:)-.25 E 2.5
(@0)108 326.4 S(xHHHHHH)-2.5 E(Carries he)144 338.4 Q
(x-encoded bit\215ags of what kind of format this dataset really is in.)
-.15 E 1.256(This is to ensure that `)144 362.4 R(`featurefullness')-.74
E 3.756('r)-.74 G 1.257(elation of: router <= scheduler <= T)-3.756 F
1.257(A-programs is not)-.93 F
(violated, and that the messages in the spool meet this criteria too.)
144 374.4 Q(Rolling binaries back too f)144 398.4 Q
(ar might break things.)-.1 E 2.5(i1)108 427.2 S(23456\255789)-2.5 E
.249(the name of the message \214le in the)144 439.2 R F2(POST)2.749 E
(OFFICE)-.18 E F1(/queue)A F0 .248
(directory and of the message control \214le)2.749 F 1.917(in the)144
451.2 R F2(POST)4.417 E(OFFICE)-.18 E F1(/transport)A F0(directory)4.417
E 6.917(.t)-.65 G 1.918
(he system and therefore are named by their inode)-6.917 F(number)144
463.2 Q(.)-.55 E 2.5(oN)108 492 S(NNNNNN)-2.5 E(the byte of)144 504 Q
(fset of the message body in the original message.)-.25 E(The follo)108
532.8 Q(wing \214elds will frequently e)-.25 E(xist:)-.15 E 2.5(eu)108
561.6 S(ser@some.domain)-2.5 E(is the return address for error messages\
, in a form that can be put in a T)144 573.6 Q(o: header line.)-.8 E 2.5
(l<)108 602.4 S(mumble@jumble>)-2.5 E .433
(is a string identifying this message in log entries.)144 614.4 R -.8
(Ty)5.433 G .433(pically the message id of the message w).8 F(ould)-.1 E
(be used.)144 626.4 Q(The follo)108 655.2 Q
(wing \214elds will occasionally appear:)-.25 E 2.5(x<)108 684 S
(jumble@mumble>)-2.5 E .347(is the log identi\214cation string \(usuall\
y a message id\) of an obsoleted message.)144 696 R .348
(The scheduler will)5.348 F(pur)144 708 Q(ge an)-.18 E 2.5(ys)-.15 G
(uch identi\214ed message after running sanity checks.)-2.5 E(17 No)
279.965 768 Q 2.5(v2)-.15 G 200.465(000 7)-2.5 F EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R 2.5
(v.)108 84 S(./public/v_\214lename)-2.5 E .337
(is the name of a \214le that the deli)144 96 R -.15(ve)-.25 G .336
(ry system can appended log information to.).15 F .336(This w)5.336 F
.336(ould appear)-.1 F(as the result of running)144 108 Q/F1 10
/Times-Bold@0 SF(sendmail -v)2.5 E F0(or)2.5 E F1(Mail -v)2.5 E F0(.)A
.348(Since all programs need to refer to the same \214le, on mail clust\
ers it is recommended that this be a)144 132 R(relati)144 144 Q .3 -.15
(ve p)-.25 H(ath naming a \214le within the).15 E/F2 10/Times-Italic@0
SF(POST)2.5 E(OFFICE)-.18 E F0(directory hierarch)2.5 E -.65(y.)-.05 G
2.976(Am)108 172.8 S .475
(essage control \214le must contain at least one address "group".)-2.976
F .475(Each group consists of a sender address)5.475 F(\214eld, one or \
more recipient address \214elds, and a message header that goes along w\
ith these.)108 184.8 Q(An address \214eld is a string containing a spac\
e-separated 4-tuple \(quad\) as follo)108 208.8 Q(ws:)-.25 E(channel)108
237.6 Q(is the name of the deli)144 249.6 Q -.15(ve)-.25 G
(ry channel for this address.).15 E(This must be a contiguous w)5 E
(ord.)-.1 E 16.83(host is)108 278.4 R(the name of the ne)2.5 E
(xt destination host for this address.)-.15 E
(This too must be a contiguous w)5 E(ord.)-.1 E 16.84(user is)108 307.2
R 1.103
(the address to be handed to the destination host for further deli)3.603
F -.15(ve)-.25 G(ry).15 E 6.103(.T)-.65 G 1.104(his string may contain)
-6.103 F 2.5(space. It)144 319.2 R
(is distinguishable because the last component cannot contain spaces.)
2.5 E(pri)108 348 Q(vile)-.25 E(ge)-.15 E
(is the numeric uid representing the pri)144 360 Q(vile)-.25 E
(ges associated with this address.)-.15 E
(The address group components are:)108 388.8 Q 2.5(s<)108 417.6 S
(address quad>)-2.5 E
(carries a sender address \214eld in address-quad form.)144 429.6 Q 2.5
(rP)108 458.4 S(PPPPPDDDD<address quad>)-2.5 E .895
(is a recipient address \214eld in address quad form, b)144 470.4 R .894
(ut also contains \214elds for transprort agent pid)-.2 F(number \(PPPP\
PP\), and a four character space for delay reporting by the scheduler \
\(DDDD\).)144 482.4 Q 2.5(Ns)108 511.2 S(tring)-2.5 E(are the deli)144
523.2 Q -.15(ve)-.25 G(ry-status-noti\214cation parameters for the pre)
.15 E(vious recipient.)-.25 E 2.5(ns)108 552 S 3.22(tring is)-2.5 F
(the deli)2.5 E -.15(ve)-.25 G(ry-status-noti\214cation en).15 E
(vironment id data for the pre)-.4 E(vious recipient.)-.25 E 2.5(Rs)108
580.8 S(tring)-2.5 E(The DSN RET)144 592.8 Q
(-mode setting \(HDRS/FULL\) for the pre)-.92 E(vious recipient.)-.25 E
2.5(Xn)108 621.6 S(nnnnn)-2.5 E .896
(is an XOR recipient address \214eld.)144 633.6 R .896
(The \214rst element is a tag \(a class number\) to identify collec-)
5.896 F .826(tions of recipient addresses which are equi)144 645.6 R
-.25(va)-.25 G .826(lent \(and therefore mutually e).25 F(xclusi)-.15 E
-.15(ve)-.25 G 3.326(\). This).15 F .826(is fol-)3.326 F(lo)144 657.6 Q
(wed by an address \214eld as described abo)-.25 E -.15(ve)-.15 G(.).15
E 28.22(mc)108 686.4 S
(arries the message header for this address group.)-28.22 E .746(After \
one or more of these address groups, the error messages for addresses a\
re appended to the message)108 715.2 R(control \214le.)108 727.2 Q
(This is done by the)5 E F2(sc)2.5 E(heduler)-.15 E F0(as it recei)2.5 E
-.15(ve)-.25 G 2.5(se).15 G(rror reports from transport agents.)-2.5 E
(17 No)279.965 768 Q 2.5(v2)-.15 G 200.465(000 8)-2.5 F EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R 2.5
(d<)108 84 S(diag-string>)-2.5 E
(Is storage format for diagnostics for recipient addresses.)144 96 Q
(Structure of the diagnostic string is:)144 120 Q(d)149 132 Q/F1 10
/Times-Italic@0 SF(id)2.5 E F0(:)A F1(header)A(of)-.45 E(fset)-.18 E F0
(:)A F1(drptof)A(fset)-.18 E F0(::)A F1(dia)A(gtime)-.1 E F0(\\t)A F1
(notarydata)A F0(\\t)A F1(messa)A -.1(ge)-.1 G F0 2.5(d1)149 144 S
(72:347:226::964917927 ...)-2.5 E(The)144 168 Q F1(id)2.5 E F0
(\214eld tells the byte of)2.5 E(fset to tge `)-.25 E(`r')-.74 E 2.5('o)
-.74 G 2.5(ft)-2.5 G(he recei)-2.5 E -.15(ve)-.25 G 2.5(rd).15 G
(e\214nition line.)-2.5 E(The)144 192 Q F1(header)3.278 E(of)-.45 E
(fset)-.18 E F0(gi)3.278 E -.15(ve)-.25 G 3.278(st).15 G .778
(he byte of)-3.278 F .778(fset of the \214rst byte of the)-.25 F F1
(header)3.277 E(s)-.1 E F0 .777(associated with the address)3.277 F
(group.)144 204 Q(The)144 228 Q F1(drptof)2.5 E(fset)-.18 E F0
(points to the possible `)2.5 E(`N')-.74 E 2.5('l)-.74 G(ine.)-2.5 E
(The)144 252 Q F1(dia)2.5 E(gtime)-.1 E F0(is just system time of the e)
2.5 E -.15(ve)-.25 G(nt.).15 E(The)144 276 Q F1(notarydata)3.278 E F0
(and)3.278 E F1(messa)3.278 E -.1(ge)-.1 G F0 .778(are e)3.378 F .778
(xplained further belo)-.15 F 2.079 -.65(w, a)-.25 H .779
(nd are identical to the transport-agent).65 F
(to the scheduler communication protocol objects of the same name.)144
288 Q -.15(Fo)108 316.8 S 3.249(re).15 G .749(xample, this is a typical\
 message control \214le \(it is a snapshot tak)-3.399 F .748
(en while a transport agent w)-.1 F .748(as run-)-.1 F(ning\):)108 328.8
Q 2.5(i1)144 345.6 S(5582)-2.5 E 2.5(o6)144 357.6 S(0)-2.5 E 2.5(l<)144
369.6 S(90Jun3.165355edt.15582@neat.cs.toronto.edu>)-2.5 E 2.5(eR)144
381.6 S(ayan Zachariassen <rayan>)-2.5 E 2.5(sl)144 393.6 S
(ocal - rayan 7)-2.5 E(r~ 23456)144 405.6 Q(local - rayan 7)7.5 E(m)144
417.6 Q(Recei)144 429.6 Q -.15(ve)-.25 G
(d: by neat.cs.toronto.edu id <15582>; Sun, 3 Jun 1990 16:53:55 -0400)
.15 E 30.65(From: Rayan)144 441.6 R(Zachariassen <rayan>)2.5 E -.8(To)
144 453.6 S 44.51(:r).8 G(ayan)-44.51 E
(Subject: a typical message control \214le)144 465.6 Q
(Message-Id: <90Jun3.165355edt.15582@neat.cs.toronto.edu>)144 477.6 Q 5
(Date: Sun,)144 489.6 R 2.5(3J)2.5 G(un 1990 16:53:54 -0400)-2.5 E/F2
10.95/Times-Bold@0 SF(TRANSPOR)72 535.2 Q 2.738(TA)-.438 G(GENT INTERF)
-3.34 E -.602(AC)-.986 G(E).602 E F0 1.196(The transport agent interf)
108 547.2 R 1.196(ace follo)-.1 F 1.196(ws master)-.25 F(-sla)-.2 E
1.497 -.15(ve -)-.2 H 1.197(model, where the T).15 F 3.697(Ai)-.93 G
1.197(nforms the)-3.697 F F1(sc)3.697 E(heduler)-.15 E F0 1.197
(that it is)3.697 F .813(ready for the w)108 559.2 R .813
(ork, and then the scheduler sends it one job description, and a)-.1 F
-.1(wa)-.15 G .813(its for diagnostics.).1 F(Once)5.812 E
(the job is \214nished, the T)108 571.2 Q 2.5(An)-.93 G
(oti\214es the scheduler that it is ready for a ne)-2.5 E 2.5(wj)-.25 G
(ob)-2.5 E(.)-.4 E 2.5(As)108 600 S(hort sample session looks lik)-2.5 E
2.5(et)-.1 G(his:)-2.5 E(S:)144 616.8 Q F1(\(start the tr)2.5 E
(ansport a)-.15 E -.1(ge)-.1 G(nt\)).1 E F0 -.5(T:)144 628.8 S/F3 10
/Times-Bold@0 SF(#hungry)3 E F0(S:)144 640.8 Q F1(spoolid\\)2.5 E F3(t)A
F1(hostspec)A F0 -.5(T:)144 652.8 S F3(diagnostics)3 E F0 -.5(T:)144
664.8 S F3(#hungry)3 E F0(\(etc. acti)144 676.8 Q .3 -.15(ve w)-.25 H
(ork\)).05 E -.5(T:)144 688.8 S F3(#hungry)3 E F0(S:)144 700.8 Q F1
(#idle)2.5 E F0 -.5(T:)144 712.8 S F3(#hungry)3 E F0(\(the scheduler mo)
144 724.8 Q -.15(ve)-.15 G 2.5(dt).15 G(he T)-2.5 E 2.5(Ai)-.93 G
(nto IDLE pool\))-2.5 E(17 No)279.965 768 Q 2.5(v2)-.15 G 200.465(000 9)
-2.5 F EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R(S:)
144 84 Q/F1 10/Times-Italic@0 SF(spoolid\\)2.5 E/F2 10/Times-Bold@0 SF
(t)A F1(hostspec)A F0(\(the T)144 96 Q 2.5(Aw)-.93 G(as reacti)-2.6 E
-.25(va)-.25 G(ted from the IDLE pool\)).25 E -.5(T:)144 108 S F2
(#hungry)3 E F0(S:)144 120 Q F2(EOF)2.5 E F0
(\(the scheduler determined that the T)144 132 Q 2.5(As)-.93 G
(hould be killed\))-2.5 E -.5(T:)144 144 S F1(\(e)3 E(xits\))-.2 E F0
(\("S" = Scheduler)108 160.8 Q 2.5(,")-.4 G(T" = T)-2.5 E
(ransport agent\))-.35 E(Normal diagnostic output is of the form:)108
189.6 Q F1(id)144 206.4 Q F0(/)A F1(of)A(fset)-.18 E F0(\\t)A F1
(notarydata)A F0(\\t)A F1(status messa)A -.1(ge)-.1 G F0(where:)108
223.2 Q 25.72(id is)108 252 R(the inode number of the message \214le,)
2.5 E(of)108 280.8 Q 10.98(fset is)-.25 F 2.5(ab)2.5 G(yte of)-2.5 E(fs\
et within its control \214le where the address being reported on is k)
-.25 E(ept,)-.1 E(notarydata)108 309.6 Q .439
(is a Ctrl-A separated quintet/se)144 321.6 R .439(xtet carrying deli)
-.15 F -.15(ve)-.25 G .439
(ry-status-noti\214cation information for the recipi-).15 F(ent.)144
333.6 Q F1(Status)5 E F0(is one of)2.5 E F2(ok)2.5 E F0(,)A F2(err)2.5 E
(or)-.18 E F0(,)A F2(deferr)2.5 E(ed)-.18 E F0 2.5(,o)C(r)-2.5 E F2 -.18
(re)2.5 G(tryat).18 E F0 2.5(,a)C(nd the)-2.5 E(message)108 362.4 Q .445
(is descripti)144 374.4 R .745 -.15(ve t)-.25 H -.15(ex).15 G 2.945(ta)
.15 G .445(ssociated with the report.)-2.945 F .445(The te)5.445 F .445
(xt is terminated by a linefeed.)-.15 F(An)5.445 E 2.945(yo)-.15 G .445
(ther for)-2.945 F(-)-.2 E .239(mat \(as might be produced by subproces\
ses\) is passed to standard output for logging in the)144 386.4 R F2
(sched-)2.739 E(uler)144 398.4 Q F0 2.547(log. The)2.548 F F2 -.18(re)
2.547 G(tryat).18 E F0 .047(response will assume the \214rst w)2.547 F
.047(ord of the te)-.1 F .047(xt is a numeric parameter)-.15 F 2.547(,e)
-.4 G(ither)-2.547 E 1.09(an incremental time in seconds if pre\214x)144
410.4 R 1.091(ed by)-.15 F F2(+,)3.591 E F0 1.091
(or otherwise an absolute time in seconds since)3.591 F(epoch.)144 422.4
Q(The e)108 451.2 Q(xit status is a code from)-.15 E F2(<sysexits.h>)2.5
E F0(.)A(The notarydata has Control-A separated sub-\214elds, \214v)108
480 Q 2.5(eo)-.15 G 2.5(rs)-2.5 G(ix of them:)-2.5 E
(Final-Rcpt-Address DSN-Action ENH-Status Report-String WTT)144 496.8 Q
(-Host [WTT)-.92 E(-T)-.92 E(Aid])-.93 E(Final-Rcpt-Address)108 530.4 Q
.05(This is the \214nal form of the recipient address used at the \214n\
al deli)144 542.4 R -.15(ve)-.25 G .05(ry of which the diagnostic data)
.15 F(is report about.)144 554.4 Q(Compare with ORCPT= data!)5 E
(DSN-Action)108 583.2 Q(One of: "deli)144 595.2 Q -.15(ve)-.25 G
(red", "f).15 E(ailed", relayed", "delayed", "e)-.1 E 2.5(xpanded". See)
-.15 F(RFC 1892.)2.5 E(ENH-Status)108 624 Q
(Enhanced status code per RFC 2034.)144 636 Q(Report-String)108 664.8 Q
2.5(Af)144 676.8 S(ree-form te)-2.5 E
(xt \(one line, no e.g. CRs enbedded\).)-.15 E(WTT)108 705.6 Q(-Host)
-.92 E -.15(Fo)144 717.6 S 2.5(rS).15 G
(MTP systems to produce "Remote-MT)-2.5 E(A:" header contents.)-.93 E
(17 No)279.965 768 Q 2.5(v2)-.15 G 195.465(000 10)-2.5 F EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R(WTT)
108 84 Q(-T)-.92 E(Aid)-.93 E .396(ZMailer speci\214c e)144 96 R .397(x\
tension to report the process name and PID number of the transport agen\
t pro-)-.15 F(ducing this report.)144 108 Q(Helps to hunt for the syslo\
gged data relating to this diagnostics instance.)5 E/F1 10.95
/Times-Bold@0 SF(ST)72 141.6 Q -1.04(AT)-.986 G(ISTICS LOG FORMA)1.04 E
(T)-1.04 E F0(The statistics log reports condenced performance oriented\
 information in follo)108 153.6 Q(wing format:)-.25 E 27.83
(timestamp \214leid)144 177.6 R 20.72(dt1 dt2)37.04 F
(state $channel/$host)16.02 E 24.5(812876190 90401-2)144 189.6 R 31(05)
29.27 G(ok usenet/\255)-4.7 E 24.5(812876228 90401-1)144 201.6 R 31(07)
29.27 G(ok usenet/\255)-4.7 E 24.5(812876244 90401-1)144 213.6 R 31(01)
29.27 G(ok local/gopher\255admin)-4.7 E 24.5(812876244 90401-1)144 225.6
R 31(05)29.27 G(ok smtp/funet.\214)-4.7 E 24.5(812876559 90401-1)144
237.6 R 28.5(02)29.27 G 23.8(1o)-28.5 G 2.5(ks)-23.8 G(mtp/utu.\214)-2.5
E(where the \214elds are:)108 261.6 Q(timestamp)108 290.4 Q
(The original spool\214le ctime \(creation time\) stamp in decimal.)144
302.4 Q 12.94(\214leid Spool\214le)108 331.2 R
(name after the router has processed it)2.5 E 20.72(dt1 The)108 360 R
(time dif)2.5 E(ference from spool\214le ctime to scheduler control \
\214le creation by the router)-.25 E 20.72(dt2 The)108 388.8 R(time dif)
2.5 E(ference from scheduler \214le ctime to the deli)-.25 E -.15(ve)
-.25 G(ry that is logged on).15 E 15.17(state What)108 417.6 R 2.5
(happened? V)2.5 F(alues: ok, error)-1.11 E 2.5(,e)-.4 G(xpiry)-2.65 E
($channel/$host)108 446.4 Q(Where/ho)144 458.4 Q 2.5(wi)-.25 G 2.5(tw)
-2.5 G(as processed)-2.6 E F1(MAILQ\(v1\) PR)72 487.2 Q -2.059 -.438
(OT O)-.329 H(COL).438 E F0 .946(Upon accepting a TCP connection on the)
108 499.2 R/F2 10/Times-Bold@0 SF(MAILQ)3.446 E F0 .946
(port \(TCP port 174\), the)3.446 F/F3 10/Times-Italic@0 SF(sc)3.446 E
(heduler)-.15 E F0 .945(dumps data to the)3.446 F
(TCP stream in the follo)108 511.2 Q
(wing format and immediately closes the connection:)-.25 E
(The TCP stream syntax is:)108 528 Q F2 -.1(ve)144 552 S(rsion).1 E F3
(id)2.5 E F2(\\n)A F3(data in id-dependent format)144 564 Q F0(<)A F3
(close)A F0(>)A .174
(The \214rst line \(all bytes up to an ASCII LF character)108 592.8 R
2.675(,o)-.4 G .175
(ctal 12\) is used to identify the syntax of all bytes fol-)-2.675 F(lo)
108 604.8 Q .666(wing the line terminator)-.25 F F2(LF)3.166 E F0 5.666
(.T)C .665(he \214rst 8 characters of the \214rst line are ")-5.666 F F2
-.1(ve)C(rsion).1 E F0 3.165("a)3.165 G 3.165(sac)-3.165 G .665
(heck that this is)-3.165 F .296(indeed a)108 616.8 R F2(MAILQ)2.796 E
F0 .296(port serv)2.796 F .297(er that has been reached, the remaining \
bytes are the real data format identi\214ca-)-.15 F 2.5(tion. The)108
628.8 R(data is interpreted according to that format until the terminat\
ing connection close.)2.5 E -.15(Fo)108 645.6 S 1.002
(rmat identi\214ers should be re).15 F 1.001(gistered with the author)
-.15 F 6.001(.T)-.55 G 1.001(he only one currently de\214ned is ")-6.001
F F2 1.001(zmailer 1.0)B F0(".)A -.15(Fo)108 657.6 S 2.5(rt).15 G
(hat data format, the syntax of the data follo)-2.5 E(wing the \214rst)
-.25 E F2(LF)2.5 E F0(is:)2.5 E F2 -1(Ve)144 681.6 S(rtices:\\n)1 E F0
(\(<)144 693.6 Q F3 -.1(ke)C(y)-.2 E F0(>)A F2(:\\t)A F0(><)A F3
(msg-\214le)A F0(>)A F2(\\t)A F0(><)A F3(n-addr)A(s)-.1 E F0(>)A F2(;)A
F0(<)2.5 E F3(of)A(f1)-.18 E F0(>\()A F2(,)A F0(<)A F3(of)A(fN)-.18 E F0
(>\)*)A F2(\\t)A F0(>[)A F2(#)A F0(<)A F3(te)A(xt)-.2 E F0(>])A F2(\\n)A
F0(\)*)A(\()144 705.6 Q F2(Channels:\\n)A F0(\(<)144 717.6 Q F3(wor)A(d)
-.37 E F0(>)A F2(:\\t)A F0(>\()A F2(>)A F0(<)A F3 -.1(ke)C(y)-.2 E F0
(>\)+)A F2(\\n)A F0(\)+)A F2(Hosts:\\n)144 729.6 Q F0(17 No)279.965 768
Q 2.5(v2)-.15 G 195.465(000 11)-2.5 F EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R(\(<)
144 84 Q/F1 10/Times-Italic@0 SF(wor)A(d)-.37 E F0(>)A/F2 10
/Times-Bold@0 SF(:\\t)A F0(>\()A F2(>)A F0(<)A F1 -.1(ke)C(y)-.2 E F0
(>\)+)A F2(\\n)A F0(\)+\)?)A F2(End:\\n)144 96 Q F0
(<mailq -Q thread and status report>)144 108 Q(Where:)108 132 Q F2(\\n)
20.97 E F0(is an ASCII linefeed)85.26 E F2(\\t)158.4 144 Q F0
(is an ASCII tab)87.49 E F1 -.1(ke)158.4 156 S(y)-.2 E F0
(is an unsigned decimal number)80.68 E F1(msg-\214le)158.4 168 Q F0
(is a contiguous string \(it is the message)61.94 E(\214le name relati)
252 180 Q .3 -.15(ve t)-.25 H 2.5(oak).15 G(no)-2.5 E(wn directory\))
-.25 E F1(n-addr)158.4 192 Q(s)-.1 E F0
(is an unsigned decimal number \(number of)62.59 E(addresses\))252 204 Q
F1(of)158.4 216 Q(f1)-.18 E F0(...)A F1(of)A(fN)-.18 E F0
(are unsigned decimal numbers)53.67 E(\(address byte of)252 228 Q
(fsets\))-.25 E F1(te)158.4 240 Q(xt)-.2 E F0
(is a string not containing an ASCII linefeed)79.36 E
(\(status message\))252 252 Q F1(wor)158.4 264 Q(d)-.37 E F0
(is a contiguous string)73.41 E 2.5(a")158.4 288 S
(contiguous string" is a sequence of printable)-2.5 E
(non-space characters)158.4 300 Q -.15(Fo)108 328.8 S 2.5(re).15 G
(xample, here is sample output from connecting to the)-2.65 E F2(MAILQ)
2.5 E F0(port:)2.5 E -.15(ve)144 352.8 S(rsion zmailer 1.0).15 E -1.11
(Ve)144 364.8 S(rtices:)1.11 E(311424:37141; 116)144 376.8 Q
(311680:64722; 151,331#128.100.8.4: Null read! \(will retry\))144 388.8
Q(312192:63471; 152#128.89.0.93: connect: Connection timed out \(will r\
etry\))144 400.8 Q(Channels:)144 412.8 Q(smtp:>311424>311680>312192)144
424.8 Q(Hosts:)144 436.8 Q(scg.toronto.edu:>311424)144 448.8 Q
(mv04.ecf.toronto.edu:>311680)144 460.8 Q(relay1.cs.net:>312192)144
472.8 Q .005(This is suf)108 501.6 R .006(\214cient information to be a\
ble to reconstruct the transport queues as seen by the scheduler proces\
s,)-.25 F .406(and to \214nd more information than what is sho)108 513.6
R .405(wn here by actually looking up the message control and data)-.25
F(\214les referred to.)108 525.6 Q/F3 10.95/Times-Bold@0 SF(MAILQv2 PR)
72 542.4 Q -2.059 -.438(OT O)-.329 H(COL).438 E F0 2.32
(The MAILQv2 protocol is interacti)108 554.4 R 2.62 -.15(ve a)-.25 H
2.32(utenticating protocol, unlik).15 F 4.82(ei)-.1 G 2.32
(ts predecessor \(v1\).)-4.82 F 2.32(The system)7.32 F(be)108 566.4 Q
.16(gins with a greeting telling v)-.15 F .16(ersion, and then gi)-.15 F
.16(ving one line of challenge to be used in subsequent auten-)-.25 F
(tication command:)108 578.4 Q -.15(ve)144 602.4 S(rsion zmailer 2.0\\n)
.15 E(MAILQ-V2-CHALLENGE: 942665308.906504.3\\n)144 614.4 Q
(Protocol commands are:)108 643.2 Q -.55(AU)108 660 S(TH username he).55
E(xauthenticator)-.15 E .567(The "login" of the mailq session.)144 672 R
.568(The he)5.567 F .568(xauthenticator is lo)-.15 F .568(wercase he)
-.25 F .568(xadecimal character print-)-.15 F 1.164
(out of MD5 checksum ran o)144 684 R -.15(ve)-.15 G 3.663(rt).15 G 1.163
(he catenate of the challenge string \(without its ending ne)-3.663 F
(wline)-.25 E 1.157(character\), and the user')144 696 R 3.657(sp)-.55 G
(assw)-3.657 E 3.658(ord. This)-.1 F 1.158
(algorithm is essentially the same what APOP scheme)3.658 F(uses.)144
708 Q(17 No)279.965 768 Q 2.5(v2)-.15 G 195.465(000 12)-2.5 F EP
%%Page: 13 13
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R(SHO)
108 84 Q 2.5(WS)-.35 G(NMP)-2.5 E(Implements 'mailq -QQQ'.)144 96 Q(SHO)
108 112.8 Q 2.5(WQ)-.35 G(UEUE SHOR)-2.6 E(T)-.6 E
(Implements 'mailq -QQ'.)144 124.8 Q(SHO)108 141.6 Q 2.5(WQ)-.35 G
(UEUE THREADS)-2.6 E(Implements 'mailq -Q'.)144 153.6 Q(SHO)108 170.4 Q
2.5(WT)-.35 G(HREAD channel host)-2.5 E .532
(Reports details usable to implement mailq-v1 lik)144 182.4 R 3.032(ei)
-.1 G(nterf)-3.032 E 3.031(ace. The)-.1 F .531(details are T)3.031 F
.531(AB separated \214elds)-.93 F(in a line until an LF)144 194.4 Q 5
(.F)-.8 G(ields are:)-5 E(1\) \214lepath under $POST)180 218.4 Q
(OFFICE/transport/)-.18 E
(2\) line number within a group, 0 starts a group)180 230.4 Q
(3\) error address in brack)180 242.4 Q(ets)-.1 E(4\) recipient line of)
180 254.4 Q(fset within the control \214le)-.25 E(5\) message e)180
266.4 Q(xpiry time \(time_t\))-.15 E(6\) ne)180 278.4 Q(xt w)-.15 E(ak)
-.1 E(eup time \(time_t\))-.1 E(7\) last feed time \(time_t\))180 290.4
Q(8\) count of attempts at the deli)180 302.4 Q -.15(ve)-.25 G(ry).15 E
(9\) "retry in NNN" or a pending on "channel"/"thread")180 314.4 Q
(10\) possible diagnostic message from pre)180 326.4 Q(vious deli)-.25 E
-.15(ve)-.25 G(ry attempt).15 E .4 LW 157.16 357.7 152.16 357.7 DL
(ETRN etrn)108 355.2 Q(string)5 E
(Supports ETRN-cluster subsystem at smtpserv)144 367.2 Q(er)-.15 E(.)
-.55 E(KILL MSG spoolid)108 384 Q(Unimplemented.)144 396 Q
(KILL THREAD channel host)108 412.8 Q(Unimplemented.)144 424.8 Q
(Responses are written out to same sock)108 441.6 Q(et in POP-lik)-.1 E
2.5(em)-.1 G(anner:)-2.5 E -.55(AU)144 465.6 S(TH .... \\n).55 E 2.5
(+OK or -LOGIN)144 477.6 R -.74(FA)2.5 G(ILED \\n).74 E(SHO)144 501.6 Q
2.5(WS)-.35 G(NMP\\n)-2.5 E(+OK until LF)144 513.6 Q(.LF\\n)-.8 E(te)144
525.6 Q(xt\\n)-.15 E(te)144 537.6 Q(xt\\n)-.15 E(.\\n)144 549.6 Q
(If the output te)108 578.4 Q(xt contains a dot at the be)-.15 E
(ginning of the line, it is duplicated in SMTP \(and POP\) style.)-.15 E
1.366(Of v)108 595.2 R 1.366(arious commands, the "SHO)-.25 F 1.366
(W" class implements multiple te)-.35 F 1.366
(xt-line outputs, others only "+OK" \(or)-.15 F("-ERR..."\).)108 607.2 Q
/F1 10.95/Times-Bold@0 SF(MAILQv2 A)72 628.8 Q(UTHENTICA)-.548 E
(TION FILE)-1.04 E F0 -.15(Fo)108 640.8 S 3.469(ra).15 G .969
(utenticating MAILQv2 protocol users, system can use)-3.469 F/F2 10
/Times-Italic@0 SF -.9(PA)3.469 G(RAMauth\214le="/path/to/\214le).9 E
(.auth")-.15 E F0 -.92(PA)3.468 G(RAM-).92 E .667(assignment to identif\
y \214le containing the data, and with the \214le to authenticate and p\
arametrize what user)108 652.8 R(can do thru the MAILQv2 port.)108 664.8
Q(#)108 693.6 Q 2.5(#A)108 705.6 S(POP-lik)-2.5 E 2.5(ea)-.1 G
(uthentication control \214le for the ZMailer scheduler)-2.5 E(.)-.55 E
(#)108 717.6 Q 2.5(#F)108 729.6 S
(ields are double-colon \(':'\) separated, and are:)-2.5 E(17 No)279.965
768 Q 2.5(v2)-.15 G 195.465(000 13)-2.5 F EP
%%Page: 14 14
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R 7.5
(#-)108 84 S(Username)-5 E 7.5(#-)108 96 S(PLAINTEXT P)-5 E(ASSW)-.92 E
(ORD \(which must not ha)-.1 E .3 -.15(ve d)-.2 H(ouble-colon in it!\))
.15 E 7.5(#-)108 108 S(Enabled attrib)-5 E(utes \(tok)-.2 E
(ens, space separated\))-.1 E 7.5(#-)108 120 S(IP A)-5 E(CLs)-.4 E(#)108
132 Q 2.5(#S)108 144 S
(ame userid CAN appear multiple times, parsing will pick the \214rst)
-2.5 E 2.5(#i)108 156 S(nstance of it which has matching IP address set)
-2.5 E(#)108 168 Q 2.5(#T)108 180 S(he def)-2.5 E
(ault-account for 'mailq' is 'nobody' with passw)-.1 E(ord 'nobody'.)-.1
E 2.5(#T)108 192 S(hird \214eld is at the moment a W)-2.5 E(ORK IN PR)
-.1 E(OGRESS!)-.4 E(#)108 204 Q 2.5(#S)108 216 S(ECURITY NO)-2.5 E(TE:)
-.4 E 7.5(#O)108 228 S 17.91(WNER: root)-7.85 F 7.5(#P)108 240 S -.4
(ROT)-7.5 G(ECTION: 0600).4 E(#)108 252 Q 2.5(#A)108 264 S(ttrib)-2.5 E
(ute tok)-.2 E(ens:)-.1 E 31(#A)108 276 S 14.06(LL well,)-31 F 2.5(aw)
2.5 G(ild-card enabling e)-2.5 E -.15(ve)-.25 G(rything).15 E 31(#S)108
288 S 6.27(NMP "SHO)-31 F 2.5(WS)-.35 G(NMP")-2.5 E 31(#Q)108 300 S
21.56(Q")-31 G(SHO)-21.56 E 2.5(WQ)-.35 G(UEUE SHOR)-2.6 E(T")-.6 E 31
(#T)108 312 S 23.78(T")-31 G(SHO)-23.78 E 2.5(WQ)-.35 G
(UEUE THREADS", "SHO)-2.6 E 2.5(WT)-.35 G(HREAD channel host")-2.5 E 31
(#E)108 324 S 7.39(TRN "ETRN)-31 F(etrn_string")2.5 E 31(#K)108 336 S
10.73(ILL "KILL)-31 F(THREAD channel host", "KILL MSG spoolid")2.5 E(#)
108 348 Q 2.5(#-)108 360 S 2.5(-")-2.5 G(nobody" via loopback gets dif)
-2.5 E(ferent treatment from)-.25 E 10(#")108 372 S(nobody" from an)-10
E(ywhere else.)-.15 E(#)108 384 Q(nobody:nobody:SNMP QQ TT ETRN:)108 396
Q([127.0.0.0]/8 [ipv6.0::1]/128)5 E(nobody:nobody:SNMP ETRN:)108 408 Q 5
([0.0.0.0]/0 [ipv6.0::0]/0)20 F(#w)108 420 Q
(atcher:zzzzz:SNMP QQ TT ETRN: [127.0.0.0]/8 [192.168.0.1]/32)-.1 E 32.5
(#root:zzzzzzz:ALL: [127.0.0.0]/8)108 432 R([192.168.0.2]/32)2.5 E/F1
10.95/Times-Bold@0 SF(Z-ENVIR)72 465.6 Q(ONMENT V)-.329 E(ARIABLES)
-1.478 E F0(LOGDIR)108 477.6 Q
(de\214nes location of log \214les. Example:)144 489.6 Q/F2 10
/Times-Bold@0 SF(LOGDIR=/v)2.5 E(ar/log/mail)-.1 E F0(MAILBIN)108 506.4
Q(De\214nes where e)144 518.4 Q -.15(xe)-.15 G
(cutable transport-agent binaries e).15 E(xist under $)-.15 E F2
(MAILBIN)A F0(/ta/ directory)A(.)-.65 E(MAILSHARE)108 535.2 Q
(Location of scheduler con\214guration \214les)144 547.2 Q -.92(PA)108
564 S 9.42(TH What)-.19 F -.92(PA)2.5 G(TH en)-.19 E(vironment v)-.4 E
(ariable to gi)-.25 E .3 -.15(ve t)-.25 H 2.5(ot).15 G
(ransport-agent subprograms.)-2.5 E(POST)108 580.8 Q(OFFICE)-.18 E
(de\214nes directory where all POST)144 592.8 Q
(OFFICE functions are under)-.18 E(.)-.55 E(Example:)144 604.8 Q F2
(POST)2.5 E(OFFICE=/v)-.18 E(ar/spool/postof\214ce)-.1 E F0
(SCHEDULERDIRHASH)108 621.6 Q .49(Carries a numeric v)144 633.6 R .49
(alue of `)-.25 F(`1')-.74 E 2.99('o)-.74 G 2.99(r`)-2.99 G(`2')-3.73 E
2.989('\()-.74 G .489(if de\214ned at all\), which will then o)-2.989 F
-.15(ve)-.15 G .489(rride possible `).15 F(`-H')-.74 E(')-.74 E(option.)
144 645.6 Q(SYSLOGFLG)108 662.4 Q .815(Existence of `)144 674.4 R(`c')
-.74 E 3.315('o)-.74 G 3.315(r`)-3.315 G(`C')-4.055 E 3.315('c)-.74 G
.815(haracter in v)-3.315 F .815
(alue string enables syslogging of some e)-.25 F -.15(ve)-.25 G .815
(nts as seen by).15 F(the scheduler)144 686.4 Q(.)-.55 E(ZCONFIG)108
703.2 Q(Gi)144 715.2 Q -.15(ve)-.25 G 2.5(sl).15 G(ocation of)-2.5 E/F3
10/Times-Italic@0 SF(zmailer)2.5 E(.conf)-1.11 E F0 1.833
(\214le \(and \214lename\).)146.5 727.2 R 1.832(Actually this one v)
6.833 F 1.832(ariable does)-.25 F F2(not)4.332 E F0 -.15(ove)4.332 G
1.832(rride compiled-in location of this).15 F(17 No)279.965 768 Q 2.5
(v2)-.15 G 195.465(000 14)-2.5 F EP
%%Page: 15 15
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF 324.4(SCHEDULER\(8\) SCHEDULER\(8\))72 48 R
(con\214guration \214le.)144 84 Q/F1 10.95/Times-Bold@0 SF(SIGN)72 100.8
Q(ALS)-.219 E/F2 10/Times-Bold@0 SF(SIGHUP)108 112.8 Q F0(:)A
(close and reopen the stdout/stderr log \214le.)144 124.8 Q F2(SIGTERM)
108 141.6 Q F0(:)A -.15(ex)144 153.6 S(it cleanly).15 E(.)-.65 E F2
(SIGQ)108 170.4 Q(UIT)-.1 E F0(:)A -.15(ex)144 182.4 S(it cleanly).15 E
2.5(,b)-.65 G(ut at \214rst order transporter childs to shut do)-2.7 E
(wn, and collect their status reports.)-.25 E F2(SIGALRM)108 199.2 Q F0
(:)A(check pending w)144 211.2 Q(ork.)-.1 E F2(SIGUSR1)108 228 Q F0(:)A
(reread the)144 240 Q/F3 10/Times-Italic@0 SF(sc)2.5 E(heduler)-.15 E F0
(con\214guration \214le.)2.5 E F2(SIGUSR2)108 256.8 Q F0(:)A
(dump state information to the)144 268.8 Q F3 -.37(re)2.5 G(ndezvous).37
E F0(\214le.)2.5 E F1(FILES)72 285.6 Q F3(/etc/zmailer)108 297.6 Q
(.conf)-1.11 E(/var/spool/postof)108 309.6 Q(\214ce/.pid.sc)-.18 E
(heduler \(POST)-.15 E(OFFICE/.pid.sc)-.18 E(heduler\))-.15 E
(/var/spool/postof)108 321.6 Q(\214ce/sc)-.18 E(heduler \(POST)-.15 E
(OFFICE/sc)-.18 E(heduler\))-.15 E(/var/spool/postof)108 333.6 Q
(\214ce/tr)-.18 E(ansport \(POST)-.15 E(OFFICE/tr)-.18 E(ansport\))-.15
E(/var/spool/postof)108 345.6 Q(\214ce/queue \(POST)-.18 E
(OFFICE/queue\))-.18 E F1(SEE ALSO)72 362.4 Q F0
(router\(8\), mailq\(1\))108 374.4 Q(RFC 822)108 391.2 Q
(The basic Internet email format speci\214cation)146.1 E(RFC 1123)108
403.2 Q -1.11(Va)141.1 G(rious 822 parameter clari\214cations)1.11 E(Se)
108 427.2 Q -.15(ve)-.25 G(ral e).15 E(xtended SMTP f)-.15 E
(acilities are implemented:)-.1 E(RFC 1341/1521/2045)108 451.2 Q
(MIME speci\214cation \(body)95.54 E 2.5(,f)-.65 G(ormats\))-2.5 E
(RFC 1342/1522/2047)108 463.2 Q(MIME speci\214cation \(headers\))95.54 E
(RFC 1425/1651/1869)108 475.2 Q(ESMTP EHLO frame)95.54 E -.1(wo)-.25 G
(rk).1 E(RFC 1428)108 487.2 Q(Basic MIME con)141.1 E -.15(ve)-.4 G
(rsion rules).15 E(RFC 1891)108 499.2 Q(ESMTP DSN)141.1 E(RFC 1892)108
511.2 Q(The Multipart/Report Content T)141.1 E(ype)-.8 E(RFC 1893)108
523.2 Q(Enhanced Mail System Status Codes)141.1 E(RFC 1894)108 535.2 Q
(Extensible Message format for DSNs)141.1 E(RFC 1985)108 547.2 Q
(ESMTP ETRN)141.1 E(RFC 2034)108 559.2 Q(ESMTP ENHANCEDST)141.1 E -1.11
(AT)-.93 G(USCODES)1.11 E(RFC 2852)108 571.2 Q(ESMTP DELIVERBY)141.1 E
F1 -.548(AU)72 588 S(THOR).548 E F0(This program authored and cop)108
600 Q(yright by:)-.1 E(Rayan Zachariassen <rayan@cs.toronto.edu>)108 612
Q 2.5(Ap)108 624 S(lenty of changes and se)-2.5 E -.15(ve)-.25 G
(ral real b).15 E(ug\214x)-.2 E(es by:)-.15 E
(Matti Aarnio <mea@nic.funet.\214>)108 636 Q(17 No)279.965 768 Q 2.5(v2)
-.15 G 195.465(000 15)-2.5 F EP
%%Trailer
end
%%EOF
